{"version":3,"file":"h-h.umd.development.js","sources":["../src/quicktask.ts","../src/dom/dom.incremental-dom.ts","../src/dom/dom.hyperscript.ts","../src/app/app.constants.ts","../src/router/router.root.ts","../src/router/router.ts","../src/app/app.ts","../src/component/component.factory.ts","../src/component/component.ts"],"sourcesContent":["// https://github.com/staltz/quicktask/blob/master/index.ts\n// https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/queueMicrotask#When_queueMicrotask_isnt_available\n// https://morioh.com/p/4ca3c63dbc0c\nconst getGlobal = () => {\n    if (typeof globalThis !== 'undefined') return globalThis;\n    // eslint-disable-next-line\n    if (typeof self !== 'undefined') return self;\n    if (typeof window !== 'undefined') return window;\n    if (typeof global !== 'undefined') return global;\n    throw new Error('Unable to locate global object');\n};\n\nconst globalThis: any = getGlobal();\n\nif (typeof globalThis.queueMicrotask !== 'function') {\n    globalThis.queueMicrotask = function queueMicrotask(callback: any) {\n        if (globalThis.Promise) {\n            Promise.resolve()\n                .then(callback)\n                .catch((e) =>\n                    setTimeout(() => {\n                        throw e;\n                    })\n                );\n        } else if (typeof process !== 'undefined') {\n            return process.nextTick(callback);\n        } else {\n            return setTimeout(callback);\n        }\n    };\n}\n\nexport function quicktask() {\n    return (fn: (arg?: any) => void) => globalThis.queueMicrotask(fn);\n}\n","import { HyperScriptNode } from './dom.types';\nimport { quicktask } from '../quicktask';\n\nconst schedule = quicktask();\nconst noop = (_?: unknown) => {};\nconst {\n    attr,\n    attributes = {},\n    elementClose,\n    elementOpenEnd,\n    elementOpenStart,\n    notifications = {\n        nodesCreated: noop,\n        nodesDeleted: noop,\n    },\n    patchOuter,\n    renderToString = noop,\n    skip = noop,\n    skipNode = noop,\n    text,\n    // @ts-ignore\n} = IncrementalDOM;\n\n// @see https://github.com/davidjamesstone/superviews.js/issues/32#issuecomment-274372713\nexport const attributesIDom = attributes || {};\nexport const attrIDom = attr;\nexport const elementCloseIDom = elementClose;\nexport const elementOpenEndIDom = elementOpenEnd;\nexport const elementOpenStartIDom = elementOpenStart;\nexport const notificationsIDom = notifications;\nexport const renderToStringIDom = renderToString;\nexport const textIDom = text;\nexport const skipIDom = skip;\nexport const skipNodeIDom = skipNode;\nexport const patch = (node: Element, fn: (data: unknown) => void) => {\n    return schedule(() => {\n        return patchOuter(node, fn);\n    });\n};\n\nattributesIDom.value = (el: HTMLFormElement, _name: string, value: any) => {\n    return (el.value = value === null || typeof value === 'undefined' ? '' : value);\n};\n\nattributesIDom.checked = (el: HTMLFormElement, _name: string, value: any) => {\n    return (el.checked = !!value);\n};\n\nnotificationsIDom.nodesDeleted = (nodes: HyperScriptNode[]) =>\n    nodes.forEach(\n        (node) => node && node._elementDetached && schedule(node._elementDetached as () => void)\n    );\n\nnotificationsIDom.nodesCreated = (nodes: HyperScriptNode[]) =>\n    nodes.forEach(\n        (node) => node && node._elementAttached && schedule(node._elementAttached as () => void)\n    );\n","import {\n    attrIDom,\n    elementCloseIDom,\n    elementOpenEndIDom,\n    elementOpenStartIDom,\n    skipIDom,\n    textIDom,\n} from './dom.incremental-dom';\nimport { HTMLElements, HTMLElementsAttributes, HyperScriptNode } from './dom.types';\n\nconst handlersCache = new WeakMap();\nconst eventTypes = new Map();\n// @see: https://github.com/preactjs/preact/blob/87202bd7dbcb5b94506f9388516a9c4bd289129a/compat/src/render.js#L10\nconst CAMEL_PROPS = /^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/;\n\nexport function h<T extends HTMLElements>(\n    tagName: T,\n    attributes: HTMLElementsAttributes[T],\n    children: any[]\n) {\n    const attrs = attributes || {};\n    const outerArgs = arguments;\n    const names = Object.keys(attrs);\n    const length = names.length;\n\n    function render(\n        options: {\n            skip: boolean;\n            key?: string;\n            elementAttached?: Function;\n            elementDetached?: Function;\n        } = { skip: false }\n    ) {\n        let element;\n\n        const elementAttached = attrs.elementAttached || options.elementAttached;\n        const elementDetached = attrs.elementDetached || options.elementDetached;\n        const key = attrs.key || options.key || null;\n        const skip = attrs.skip || options.skip || null;\n\n        elementOpenStartIDom(tagName, key);\n        setAttributes({ attributes: attrs, names, length });\n        elementOpenEndIDom();\n\n        if (skip) {\n            skipIDom();\n\n            element = elementCloseIDom(tagName);\n        } else {\n            if (Array.isArray(children)) {\n                children.forEach(renderChildren);\n            } else {\n                forEachChildInArgs(outerArgs, renderChildren);\n            }\n\n            element = elementCloseIDom(tagName) || {};\n\n            element._elementAttached = elementAttached;\n            element._elementDetached = elementDetached;\n\n            if (typeof window !== 'undefined') {\n                setEvents({ attributes: attrs, names, length, element });\n            }\n\n            if (typeof attrs.ref === 'function') {\n                attrs.ref(element);\n            }\n        }\n\n        return element;\n    }\n\n    return render;\n}\n\nfunction isEvent(name: string): boolean {\n    return /^on/.test(name);\n}\n\nfunction isSkip(name: string): boolean {\n    return /^skip$/.test(name);\n}\n\nfunction isRef(name: string): boolean {\n    return /^ref$/.test(name);\n}\n\nfunction setAttributes({\n    attributes,\n    names,\n    length,\n}: {\n    attributes: any;\n    names: Array<string>;\n    length: number;\n}): void {\n    for (let i = 0; i < length; i++) {\n        const name = names[i];\n\n        if (name && !isEvent(name) && !isSkip(name) && !isRef(name)) {\n            const classProp = name === 'className' ? 'class' : '';\n            const forProp = name === 'htmlFor' ? 'for' : '';\n            // @see: https://github.com/preactjs/preact/blob/87202bd7dbcb5b94506f9388516a9c4bd289129a/compat/src/render.js#L149\n            const hyphenated =\n                CAMEL_PROPS.test(name) && name.replace(/[A-Z0-9]/, '-$&').toLowerCase();\n\n            attrIDom(forProp || classProp || hyphenated || name, attributes[name]);\n        }\n    }\n}\n\nfunction setEvents({\n    attributes,\n    names,\n    length,\n    element,\n}: {\n    attributes: any;\n    names: Array<string>;\n    length: number;\n    element: HyperScriptNode;\n}): void {\n    for (let i = 0; i < length; i++) {\n        const name = names[i];\n\n        if (name && isEvent(name)) {\n            const eventName = name.toLowerCase().substring(2);\n            const handlers = handlersCache.get(element) || {};\n\n            if (!eventTypes.has(eventName)) {\n                document.body.addEventListener(eventName, eventProxy, false);\n            }\n\n            eventTypes.set(eventName, 1);\n            handlersCache.set(element, { ...handlers, [eventName]: attributes[name] });\n        }\n    }\n}\n\nfunction eventProxy(event: Event) {\n    const element = event.target as any;\n    const handlers = handlersCache.get(element) || {};\n    const type = event.type;\n\n    if (handlers[type]) {\n        return handlers[type](event);\n    }\n}\n\nfunction forEachChildInArgs(args: IArguments, iteratee: Function) {\n    if (args.length > 2) {\n        for (let i = 2; i < args.length; i++) {\n            iteratee(args[i]);\n        }\n    }\n}\n\nfunction renderChildren(children: Function | string | void) {\n    const str = typeof children === 'string' ? textIDom(children) : '';\n\n    return typeof children === 'function' ? children() : str;\n}\n","export const APP_ID = 'app';\n","// @see: https://github.com/purposeindustries/window-or-global/\nexport const root: any =\n    // eslint-disable-next-line\n    (typeof self === 'object' && self.self === self && self) ||\n    // @ts-ignore\n    (typeof global === 'object' && global.global === global && global) ||\n    window;\n","import { APP_ID } from '../app/app.constants';\nimport { View } from '../app/app.types';\nimport { patch } from '../dom';\nimport { root } from './router.root';\nimport { Params, RouterOptions } from './router.types';\n\ninterface Model {\n    [key: string]: any;\n}\n\ninterface Match {\n    params: Params;\n    title: (params: Params) => string;\n    view: View;\n}\n\ninterface SetMatcher {\n    set: (options: RouterOptions, path: string) => Match;\n}\n\nlet setClick: (link: HTMLAnchorElement) => void;\n\nconst matcher = storeMatcher();\nconst getParams = ({ params }: Match) => params;\nconst getTitle = (match: Match): string => match.title(getParams(match));\n\nexport const redirect = (href: string) => {\n    const link = root.document.createElement('a');\n\n    link.setAttribute('href', href);\n    setClick(link);\n};\nexport const to = (event: Event) => {\n    const link = event.target as HTMLAnchorElement;\n\n    event.preventDefault();\n\n    setClick(link);\n};\n\nconst initClick = (options: RouterOptions) => (link: HTMLAnchorElement) => {\n    const handler = (event: Event) => {\n        link.removeEventListener('click', handler);\n        render({ options, event });\n    };\n\n    link.addEventListener('click', handler);\n    link.click();\n};\n\nexport function router(options: RouterOptions) {\n    const path = root.location.pathname;\n    const match = matcher.set(options, path);\n\n    setClick = initClick(options);\n\n    popState(options);\n    setTitle({ match, path, isPopState: false });\n\n    return {\n        view: match.view || options.view,\n    };\n}\n\nfunction popState(options: RouterOptions) {\n    root.addEventListener('popstate', (event: Event) => render({ options, event }));\n}\n\nfunction render({ options, event }: { options: RouterOptions; event: Event }): void {\n    const target = event.currentTarget as HTMLAnchorElement;\n    const path = target.pathname || root.location.pathname;\n    const match = matcher.set(options, path);\n\n    event.preventDefault();\n\n    setTitle({\n        match,\n        path,\n        isPopState: event.type === 'popstate',\n    });\n    patch(\n        document.getElementById(options.routerId || options.id || APP_ID) as Element,\n        match.view()\n    );\n}\n\nfunction setTitle({\n    match,\n    path,\n    isPopState,\n}: {\n    match: Match;\n    path: string;\n    isPopState: boolean;\n}): void {\n    const title = getTitle(match) || root.document.title;\n\n    if (!isPopState) {\n        root.history.pushState({}, title, path);\n    }\n\n    root.document.title = title;\n}\n\n// @see https://github.com/jesseditson/fs-router/blob/v0.2.0/index.js#L7\nfunction addMatch(url: string, path: string) {\n    let matched;\n\n    const paramPattern = /:([^/]+)/;\n    const paramNames = [] as Array<any>;\n\n    while ((matched = path.match(paramPattern))) {\n        path = path.replace(paramPattern, '([^?/]+)');\n\n        paramNames.push(matched[1] as never);\n    }\n\n    const pattern = new RegExp(`^${path}(\\\\?(.*)|$)`, 'i');\n    const match = url.match(pattern);\n\n    if (match) {\n        return paramNames.reduce((map: Model, param: string, index: number) => {\n            map[param] = match[index + 1];\n\n            return map;\n        }, {});\n    }\n}\n\nfunction storeMatcher(): SetMatcher {\n    const storeMatches = new Map();\n    const noop = () => {};\n\n    return {\n        set(options: RouterOptions, url: string): Match {\n            if (!storeMatches.has(url)) {\n                let rout = '';\n                let params;\n\n                const optionsRouter = options.router;\n                const routes = Object.keys(optionsRouter);\n                const length = routes.length;\n\n                for (let i = 0; i < length; i = i + 1) {\n                    rout = routes[i];\n                    params = addMatch(url, routes[i]);\n\n                    if (params) {\n                        break;\n                    }\n                }\n\n                const item = optionsRouter[rout];\n\n                storeMatches.set(url, {\n                    params,\n                    title: item.title || noop,\n                    view: item.view || noop,\n                });\n            }\n\n            return storeMatches.get(url);\n        },\n    };\n}\n","import { patch } from '../dom';\nimport { RouterOptions, router } from '../router';\nimport { App } from './app.types';\nimport { APP_ID } from './app.constants';\n\nexport function app(options: App) {\n    const plugin = options.router && router(options as RouterOptions);\n    const view = (plugin && plugin.view) || options.view;\n    const fragment = new DocumentFragment();\n    const tempContainer = document.createElement('div');\n    const appContainer = document.getElementById(options.id || APP_ID);\n\n    if (appContainer?.hasAttribute('data-skip')) return;\n\n    fragment.appendChild(tempContainer);\n    patch((fragment.querySelector('div') as unknown) as Element, view());\n    appContainer?.parentNode?.replaceChild(tempContainer, appContainer as Element);\n}\n","import { patch } from '../dom';\nimport { Props, Render, UpdateResponse } from './component.types';\nimport { quicktask } from '../quicktask';\n\ninterface ComponentFactory {\n    hooks: any;\n    key: string;\n    onCreate: (key: string, element: Element) => void;\n    onDelete: (key: string, element: Element) => void;\n    render: Render;\n    newProps: Props;\n}\n\nconst schedule = quicktask();\n\nexport function componentFactory({\n    hooks,\n    newProps,\n    key,\n    onCreate,\n    onDelete,\n    render,\n}: ComponentFactory) {\n    const noop = () => {};\n    const keys = new Set();\n\n    let element: Element;\n    let created: (element: Element) => void = noop;\n    let deleted: (element: Element) => void = noop;\n    let props: Props = {};\n\n    const update = (currentHook: string) => {\n        return <S>(initialState: S): UpdateResponse<S> => {\n            const setStateHookIndex = currentHook;\n            const setState = (newState: S) => {\n                schedule(() => {\n                    hooks.set(setStateHookIndex, newState);\n                    patch(element, renderElement(props));\n                });\n            };\n\n            if (!hooks.has(currentHook)) {\n                hooks.set(currentHook, initialState);\n                keys.add(currentHook);\n            }\n\n            return [hooks.get(currentHook), setState];\n        };\n    };\n\n    const execute = (currentHook: string) => {\n        return (callback: () => void, depArray: any[]) => {\n            const hasNoDeps = !depArray;\n            const deps = hooks.get(currentHook);\n            const hasChangedDeps = deps\n                ? !depArray.every((item, i) => {\n                      return JSON.stringify(item) === JSON.stringify(deps[i]);\n                  })\n                : true;\n\n            if (hasNoDeps || hasChangedDeps) {\n                schedule(() => {\n                    hooks.set(currentHook, depArray);\n                    keys.add(currentHook);\n                    callback();\n                });\n            }\n        };\n    };\n\n    const renderElement = (nextProps?: Props): (() => Element | null) => {\n        let currentHook = 0;\n\n        props = nextProps || {};\n\n        const reRender = render({\n            created: (callback: (element: Element) => void) => {\n                return (created = callback || created);\n            },\n            deleted: (callback: (element: Element) => void) => {\n                return (deleted = callback || deleted);\n            },\n            execute: (callback: () => void, deps: any[]) => {\n                return execute(`execute-${key}-${currentHook++}`)(callback, deps);\n            },\n            key,\n            props,\n            update: (initialState) => {\n                return update(`update-${key}-${currentHook++}`)(initialState);\n            },\n        });\n\n        if (reRender === null) {\n            return () => {\n                return null;\n            };\n        }\n\n        return function elementCallback() {\n            element = reRender({\n                key,\n                elementAttached: () => {\n                    const e = element as any;\n\n                    e.__hooks = keys;\n                    e.__deleted = deleted;\n\n                    if (props.view) {\n                        e.dataset.view = props.view;\n                    }\n\n                    created(element);\n                    onCreate(key, element);\n                },\n                elementDetached: () => {\n                    onDelete(key, element);\n                },\n            });\n\n            return element;\n        };\n    };\n\n    return renderElement(newProps);\n}\n","import { componentFactory } from './component.factory';\nimport { Props, Render } from './component.types';\n\nlet keyCounter = 1;\n\nconst keyGenerator = () => {\n    return `__${keyCounter++}__`;\n};\n\nconst contains = new Map();\nconst elements = new Map();\nconst hooks = new Map();\n\nconst onDelete = (key: string) => {\n    (contains.get(key) || []).forEach((k: string) => {\n        const containedElement = elements.get(k);\n\n        if (containedElement) {\n            containedElement.__deleted(containedElement);\n            containedElement.__hooks.forEach((h: string) => hooks.delete(h));\n        }\n\n        contains.delete(k);\n        elements.delete(k);\n    });\n};\n\nconst setChildren = (element: Element, key: string) => {\n    // Set children and itself\n    elements.forEach((_, k) => {\n        const domElement = elements.get(k);\n\n        if (domElement && domElement.contains(element)) {\n            contains.set(k, [...(contains.get(k) || []), key]);\n        }\n    });\n};\n\nconst onCreate = (key: string, element: Element) => {\n    elements.set(key, element);\n    setChildren(element, key);\n};\n\nexport function component(render: Render) {\n    function factory(key: string, newProps?: Props) {\n        const _key = newProps && newProps.key ? newProps.key + key : key;\n\n        return componentFactory({\n            hooks,\n            key: _key,\n            newProps: newProps || {},\n            onCreate,\n            onDelete,\n            render,\n        });\n    }\n\n    function init() {\n        return factory.bind(null, keyGenerator());\n    }\n\n    return init;\n}\n"],"names":["getGlobal","globalThis","self","window","global","Error","queueMicrotask","callback","Promise","resolve","then","e","setTimeout","process","nextTick","quicktask","fn","schedule","noop","_","IncrementalDOM","attr","attributes","elementClose","elementOpenEnd","elementOpenStart","notifications","nodesCreated","nodesDeleted","patchOuter","renderToString","skip","skipNode","text","attributesIDom","attrIDom","elementCloseIDom","elementOpenEndIDom","elementOpenStartIDom","notificationsIDom","renderToStringIDom","textIDom","skipIDom","skipNodeIDom","patch","node","value","el","_name","checked","nodes","forEach","_elementDetached","_elementAttached","handlersCache","WeakMap","eventTypes","Map","CAMEL_PROPS","h","tagName","children","attrs","outerArgs","arguments","names","Object","keys","length","render","options","element","elementAttached","elementDetached","key","setAttributes","Array","isArray","renderChildren","forEachChildInArgs","setEvents","ref","isEvent","name","test","isSkip","isRef","i","classProp","forProp","hyphenated","replace","toLowerCase","eventName","substring","handlers","get","has","document","body","addEventListener","eventProxy","set","event","target","type","args","iteratee","str","APP_ID","root","setClick","matcher","storeMatcher","getParams","params","getTitle","match","title","redirect","href","link","createElement","setAttribute","to","preventDefault","initClick","handler","removeEventListener","click","router","path","location","pathname","popState","setTitle","isPopState","view","currentTarget","getElementById","routerId","id","history","pushState","addMatch","url","matched","paramPattern","paramNames","push","pattern","RegExp","reduce","map","param","index","storeMatches","rout","optionsRouter","routes","item","app","plugin","fragment","DocumentFragment","tempContainer","appContainer","hasAttribute","appendChild","querySelector","parentNode","replaceChild","componentFactory","hooks","newProps","onCreate","onDelete","Set","created","deleted","props","update","currentHook","initialState","setStateHookIndex","setState","newState","renderElement","add","execute","depArray","hasNoDeps","deps","hasChangedDeps","every","JSON","stringify","nextProps","reRender","elementCallback","__hooks","__deleted","dataset","keyCounter","keyGenerator","contains","elements","k","containedElement","setChildren","domElement","component","factory","_key","init","bind"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;EAAA;EACA;EACA;EACA,IAAMA,SAAS,GAAG,SAAZA,SAAY;EACd,MAAI,OAAOC,UAAP,KAAsB,WAA1B,EAAuC,OAAOA,UAAP;;EAEvC,MAAI,OAAOC,IAAP,KAAgB,WAApB,EAAiC,OAAOA,IAAP;EACjC,MAAI,OAAOC,MAAP,KAAkB,WAAtB,EAAmC,OAAOA,MAAP;EACnC,MAAI,OAAOC,MAAP,KAAkB,WAAtB,EAAmC,OAAOA,MAAP;EACnC,QAAM,IAAIC,KAAJ,CAAU,gCAAV,CAAN;EACH,CAPD;;EASA,IAAMJ,UAAU,gBAAQD,SAAS,EAAjC;;EAEA,IAAI,OAAOC,UAAU,CAACK,cAAlB,KAAqC,UAAzC,EAAqD;EACjDL,EAAAA,UAAU,CAACK,cAAX,GAA4B,SAASA,cAAT,CAAwBC,QAAxB;EACxB,QAAIN,UAAU,CAACO,OAAf,EAAwB;EACpBA,MAAAA,OAAO,CAACC,OAAR,GACKC,IADL,CACUH,QADV,WAEW,UAACI,CAAD;EAAA,eACHC,UAAU,CAAC;EACP,gBAAMD,CAAN;EACH,SAFS,CADP;EAAA,OAFX;EAOH,KARD,MAQO,IAAI,OAAOE,OAAP,KAAmB,WAAvB,EAAoC;EACvC,aAAOA,OAAO,CAACC,QAAR,CAAiBP,QAAjB,CAAP;EACH,KAFM,MAEA;EACH,aAAOK,UAAU,CAACL,QAAD,CAAjB;EACH;EACJ,GAdD;EAeH;;WAEeQ;EACZ,SAAO,UAACC,EAAD;EAAA,WAA6Bf,UAAU,CAACK,cAAX,CAA0BU,EAA1B,CAA7B;EAAA,GAAP;EACH;;EC/BD,IAAMC,QAAQ,gBAAGF,SAAS,EAA1B;;EACA,IAAMG,IAAI,GAAG,SAAPA,IAAO,CAACC,CAAD,IAAb;;wBAiBIC;MAfAC,uBAAAA;8CACAC;MAAAA,gDAAa;MACbC,+BAAAA;MACAC,iCAAAA;MACAC,mCAAAA;8CACAC;MAAAA,mDAAgB;EACZC,EAAAA,YAAY,EAAET,IADF;EAEZU,EAAAA,YAAY,EAAEV;EAFF;MAIhBW,6BAAAA;8CACAC;MAAAA,oDAAiBZ;6CACjBa;MAAAA,yCAAOb;8CACPc;MAAAA,8CAAWd;MACXe,uBAAAA;;AAKJ,MAAaC,cAAc,GAAGZ,UAAU,IAAI,EAArC;AACP,MAAaa,QAAQ,GAAGd,IAAjB;AACP,MAAae,gBAAgB,GAAGb,YAAzB;AACP,MAAac,kBAAkB,GAAGb,cAA3B;AACP,MAAac,oBAAoB,GAAGb,gBAA7B;AACP,MAAac,iBAAiB,GAAGb,aAA1B;AACP,MAAac,kBAAkB,GAAGV,cAA3B;AACP,MAAaW,QAAQ,GAAGR,IAAjB;AACP,MAAaS,QAAQ,GAAGX,IAAjB;AACP,MAAaY,YAAY,GAAGX,QAArB;AACP,MAAaY,KAAK,GAAG,SAARA,KAAQ,CAACC,IAAD,EAAgB7B,EAAhB;EACjB,SAAOC,QAAQ,CAAC;EACZ,WAAOY,UAAU,CAACgB,IAAD,EAAO7B,EAAP,CAAjB;EACH,GAFc,CAAf;EAGH,CAJM;;EAMPkB,cAAc,CAACY,KAAf,GAAuB,UAACC,EAAD,EAAsBC,KAAtB,EAAqCF,KAArC;EACnB,SAAQC,EAAE,CAACD,KAAH,GAAWA,KAAK,KAAK,IAAV,IAAkB,OAAOA,KAAP,KAAiB,WAAnC,GAAiD,EAAjD,GAAsDA,KAAzE;EACH,CAFD;;EAIAZ,cAAc,CAACe,OAAf,GAAyB,UAACF,EAAD,EAAsBC,KAAtB,EAAqCF,KAArC;EACrB,SAAQC,EAAE,CAACE,OAAH,GAAa,CAAC,CAACH,KAAvB;EACH,CAFD;;EAIAP,iBAAiB,CAACX,YAAlB,GAAiC,UAACsB,KAAD;EAAA,SAC7BA,KAAK,CAACC,OAAN,CACI,UAACN,IAAD;EAAA,WAAUA,IAAI,IAAIA,IAAI,CAACO,gBAAb,IAAiCnC,QAAQ,CAAC4B,IAAI,CAACO,gBAAN,CAAnD;EAAA,GADJ,CAD6B;EAAA,CAAjC;;EAKAb,iBAAiB,CAACZ,YAAlB,GAAiC,UAACuB,KAAD;EAAA,SAC7BA,KAAK,CAACC,OAAN,CACI,UAACN,IAAD;EAAA,WAAUA,IAAI,IAAIA,IAAI,CAACQ,gBAAb,IAAiCpC,QAAQ,CAAC4B,IAAI,CAACQ,gBAAN,CAAnD;EAAA,GADJ,CAD6B;EAAA,CAAjC;;EC3CA,IAAMC,aAAa,gBAAG,IAAIC,OAAJ,EAAtB;EACA,IAAMC,UAAU,gBAAG,IAAIC,GAAJ,EAAnB;;EAEA,IAAMC,WAAW,GAAG,kOAApB;AAEA,WAAgBC,EACZC,SACAtC,YACAuC;EAEA,MAAMC,KAAK,GAAGxC,UAAU,IAAI,EAA5B;EACA,MAAMyC,SAAS,GAAGC,SAAlB;EACA,MAAMC,KAAK,GAAGC,MAAM,CAACC,IAAP,CAAYL,KAAZ,CAAd;EACA,MAAMM,MAAM,GAAGH,KAAK,CAACG,MAArB;;EAEA,WAASC,MAAT,CACIC,OADJ;UACIA;EAAAA,MAAAA,UAKI;EAAEvC,QAAAA,IAAI,EAAE;EAAR;;;EAEJ,QAAIwC,OAAJ;EAEA,QAAMC,eAAe,GAAGV,KAAK,CAACU,eAAN,IAAyBF,OAAO,CAACE,eAAzD;EACA,QAAMC,eAAe,GAAGX,KAAK,CAACW,eAAN,IAAyBH,OAAO,CAACG,eAAzD;EACA,QAAMC,GAAG,GAAGZ,KAAK,CAACY,GAAN,IAAaJ,OAAO,CAACI,GAArB,IAA4B,IAAxC;EACA,QAAM3C,IAAI,GAAG+B,KAAK,CAAC/B,IAAN,IAAcuC,OAAO,CAACvC,IAAtB,IAA8B,IAA3C;EAEAO,IAAAA,oBAAoB,CAACsB,OAAD,EAAUc,GAAV,CAApB;EACAC,IAAAA,aAAa,CAAC;EAAErD,MAAAA,UAAU,EAAEwC,KAAd;EAAqBG,MAAAA,KAAK,EAALA,KAArB;EAA4BG,MAAAA,MAAM,EAANA;EAA5B,KAAD,CAAb;EACA/B,IAAAA,kBAAkB;;EAElB,QAAIN,IAAJ,EAAU;EACNW,MAAAA,QAAQ;EAER6B,MAAAA,OAAO,GAAGnC,gBAAgB,CAACwB,OAAD,CAA1B;EACH,KAJD,MAIO;EACH,UAAIgB,KAAK,CAACC,OAAN,CAAchB,QAAd,CAAJ,EAA6B;EACzBA,QAAAA,QAAQ,CAACV,OAAT,CAAiB2B,cAAjB;EACH,OAFD,MAEO;EACHC,QAAAA,kBAAkB,CAAChB,SAAD,EAAYe,cAAZ,CAAlB;EACH;;EAEDP,MAAAA,OAAO,GAAGnC,gBAAgB,CAACwB,OAAD,CAAhB,IAA6B,EAAvC;EAEAW,MAAAA,OAAO,CAAClB,gBAAR,GAA2BmB,eAA3B;EACAD,MAAAA,OAAO,CAACnB,gBAAR,GAA2BqB,eAA3B;;EAEA,UAAI,OAAOtE,MAAP,KAAkB,WAAtB,EAAmC;EAC/B6E,QAAAA,SAAS,CAAC;EAAE1D,UAAAA,UAAU,EAAEwC,KAAd;EAAqBG,UAAAA,KAAK,EAALA,KAArB;EAA4BG,UAAAA,MAAM,EAANA,MAA5B;EAAoCG,UAAAA,OAAO,EAAPA;EAApC,SAAD,CAAT;EACH;;EAED,UAAI,OAAOT,KAAK,CAACmB,GAAb,KAAqB,UAAzB,EAAqC;EACjCnB,QAAAA,KAAK,CAACmB,GAAN,CAAUV,OAAV;EACH;EACJ;;EAED,WAAOA,OAAP;EACH;;EAED,SAAOF,MAAP;EACH;;EAED,SAASa,OAAT,CAAiBC,IAAjB;EACI,SAAO,MAAMC,IAAN,CAAWD,IAAX,CAAP;EACH;;EAED,SAASE,MAAT,CAAgBF,IAAhB;EACI,SAAO,SAASC,IAAT,CAAcD,IAAd,CAAP;EACH;;EAED,SAASG,KAAT,CAAeH,IAAf;EACI,SAAO,QAAQC,IAAR,CAAaD,IAAb,CAAP;EACH;;EAED,SAASR,aAAT;QACIrD,kBAAAA;QACA2C,aAAAA;QACAG,cAAAA;;EAMA,OAAK,IAAImB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,MAApB,EAA4BmB,CAAC,EAA7B,EAAiC;EAC7B,QAAMJ,IAAI,GAAGlB,KAAK,CAACsB,CAAD,CAAlB;;EAEA,QAAIJ,IAAI,IAAI,CAACD,OAAO,CAACC,IAAD,CAAhB,IAA0B,CAACE,MAAM,CAACF,IAAD,CAAjC,IAA2C,CAACG,KAAK,CAACH,IAAD,CAArD,EAA6D;EACzD,UAAMK,SAAS,GAAGL,IAAI,KAAK,WAAT,GAAuB,OAAvB,GAAiC,EAAnD;EACA,UAAMM,OAAO,GAAGN,IAAI,KAAK,SAAT,GAAqB,KAArB,GAA6B,EAA7C,CAFyD;;EAIzD,UAAMO,UAAU,GACZhC,WAAW,CAAC0B,IAAZ,CAAiBD,IAAjB,KAA0BA,IAAI,CAACQ,OAAL,CAAa,UAAb,EAAyB,KAAzB,EAAgCC,WAAhC,EAD9B;EAGAzD,MAAAA,QAAQ,CAACsD,OAAO,IAAID,SAAX,IAAwBE,UAAxB,IAAsCP,IAAvC,EAA6C7D,UAAU,CAAC6D,IAAD,CAAvD,CAAR;EACH;EACJ;EACJ;;EAED,SAASH,SAAT;QACI1D,mBAAAA;QACA2C,cAAAA;QACAG,eAAAA;QACAG,gBAAAA;;EAOA,OAAK,IAAIgB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,MAApB,EAA4BmB,CAAC,EAA7B,EAAiC;EAC7B,QAAMJ,IAAI,GAAGlB,KAAK,CAACsB,CAAD,CAAlB;;EAEA,QAAIJ,IAAI,IAAID,OAAO,CAACC,IAAD,CAAnB,EAA2B;EAAA;;EACvB,UAAMU,SAAS,GAAGV,IAAI,CAACS,WAAL,GAAmBE,SAAnB,CAA6B,CAA7B,CAAlB;EACA,UAAMC,QAAQ,GAAGzC,aAAa,CAAC0C,GAAd,CAAkBzB,OAAlB,KAA8B,EAA/C;;EAEA,UAAI,CAACf,UAAU,CAACyC,GAAX,CAAeJ,SAAf,CAAL,EAAgC;EAC5BK,QAAAA,QAAQ,CAACC,IAAT,CAAcC,gBAAd,CAA+BP,SAA/B,EAA0CQ,UAA1C,EAAsD,KAAtD;EACH;;EAED7C,MAAAA,UAAU,CAAC8C,GAAX,CAAeT,SAAf,EAA0B,CAA1B;EACAvC,MAAAA,aAAa,CAACgD,GAAd,CAAkB/B,OAAlB,wBAAgCwB,QAAhC,kCAA2CF,SAA3C,IAAuDvE,UAAU,CAAC6D,IAAD,CAAjE;EACH;EACJ;EACJ;;EAED,SAASkB,UAAT,CAAoBE,KAApB;EACI,MAAMhC,OAAO,GAAGgC,KAAK,CAACC,MAAtB;EACA,MAAMT,QAAQ,GAAGzC,aAAa,CAAC0C,GAAd,CAAkBzB,OAAlB,KAA8B,EAA/C;EACA,MAAMkC,IAAI,GAAGF,KAAK,CAACE,IAAnB;;EAEA,MAAIV,QAAQ,CAACU,IAAD,CAAZ,EAAoB;EAChB,WAAOV,QAAQ,CAACU,IAAD,CAAR,CAAeF,KAAf,CAAP;EACH;EACJ;;EAED,SAASxB,kBAAT,CAA4B2B,IAA5B,EAA8CC,QAA9C;EACI,MAAID,IAAI,CAACtC,MAAL,GAAc,CAAlB,EAAqB;EACjB,SAAK,IAAImB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGmB,IAAI,CAACtC,MAAzB,EAAiCmB,CAAC,EAAlC,EAAsC;EAClCoB,MAAAA,QAAQ,CAACD,IAAI,CAACnB,CAAD,CAAL,CAAR;EACH;EACJ;EACJ;;EAED,SAAST,cAAT,CAAwBjB,QAAxB;EACI,MAAM+C,GAAG,GAAG,OAAO/C,QAAP,KAAoB,QAApB,GAA+BpB,QAAQ,CAACoB,QAAD,CAAvC,GAAoD,EAAhE;EAEA,SAAO,OAAOA,QAAP,KAAoB,UAApB,GAAiCA,QAAQ,EAAzC,GAA8C+C,GAArD;EACH;;ECjKM,IAAMC,MAAM,GAAG,KAAf;;ECAP;AACA,EAAO,IAAMC,IAAI;EAEZ,OAAO5G,IAAP,KAAgB,QAAhB,IAA4BA,IAAI,CAACA,IAAL,KAAcA,IAA1C,IAAkDA,IAAnD;EAEC,OAAOE,MAAP,KAAkB,QAAlB,IAA8BA,MAAM,CAACA,MAAP,KAAkBA,MAAhD,IAA0DA,MAF3D,IAGAD,MALG;;ECmBP,IAAI4G,QAAJ;EAEA,IAAMC,OAAO,gBAAGC,YAAY,EAA5B;;EACA,IAAMC,SAAS,GAAG,SAAZA,SAAY;EAAA,MAAGC,MAAH,QAAGA,MAAH;EAAA,SAAuBA,MAAvB;EAAA,CAAlB;;EACA,IAAMC,QAAQ,GAAG,SAAXA,QAAW,CAACC,KAAD;EAAA,SAA0BA,KAAK,CAACC,KAAN,CAAYJ,SAAS,CAACG,KAAD,CAArB,CAA1B;EAAA,CAAjB;;AAEA,MAAaE,QAAQ,GAAG,SAAXA,QAAW,CAACC,IAAD;EACpB,MAAMC,IAAI,GAAGX,IAAI,CAACZ,QAAL,CAAcwB,aAAd,CAA4B,GAA5B,CAAb;EAEAD,EAAAA,IAAI,CAACE,YAAL,CAAkB,MAAlB,EAA0BH,IAA1B;EACAT,EAAAA,QAAQ,CAACU,IAAD,CAAR;EACH,CALM;AAMP,MAAaG,EAAE,GAAG,SAALA,EAAK,CAACrB,KAAD;EACd,MAAMkB,IAAI,GAAGlB,KAAK,CAACC,MAAnB;EAEAD,EAAAA,KAAK,CAACsB,cAAN;EAEAd,EAAAA,QAAQ,CAACU,IAAD,CAAR;EACH,CANM;;EAQP,IAAMK,SAAS,GAAG,SAAZA,SAAY,CAACxD,OAAD;EAAA,SAA4B,UAACmD,IAAD;EAC1C,QAAMM,OAAO,GAAG,SAAVA,OAAU,CAACxB,KAAD;EACZkB,MAAAA,IAAI,CAACO,mBAAL,CAAyB,OAAzB,EAAkCD,OAAlC;EACA1D,MAAAA,MAAM,CAAC;EAAEC,QAAAA,OAAO,EAAPA,OAAF;EAAWiC,QAAAA,KAAK,EAALA;EAAX,OAAD,CAAN;EACH,KAHD;;EAKAkB,IAAAA,IAAI,CAACrB,gBAAL,CAAsB,OAAtB,EAA+B2B,OAA/B;EACAN,IAAAA,IAAI,CAACQ,KAAL;EACH,GARiB;EAAA,CAAlB;;AAUA,WAAgBC,OAAO5D;EACnB,MAAM6D,IAAI,GAAGrB,IAAI,CAACsB,QAAL,CAAcC,QAA3B;EACA,MAAMhB,KAAK,GAAGL,OAAO,CAACV,GAAR,CAAYhC,OAAZ,EAAqB6D,IAArB,CAAd;EAEApB,EAAAA,QAAQ,GAAGe,SAAS,CAACxD,OAAD,CAApB;EAEAgE,EAAAA,QAAQ,CAAChE,OAAD,CAAR;EACAiE,EAAAA,QAAQ,CAAC;EAAElB,IAAAA,KAAK,EAALA,KAAF;EAASc,IAAAA,IAAI,EAAJA,IAAT;EAAeK,IAAAA,UAAU,EAAE;EAA3B,GAAD,CAAR;EAEA,SAAO;EACHC,IAAAA,IAAI,EAAEpB,KAAK,CAACoB,IAAN,IAAcnE,OAAO,CAACmE;EADzB,GAAP;EAGH;;EAED,SAASH,QAAT,CAAkBhE,OAAlB;EACIwC,EAAAA,IAAI,CAACV,gBAAL,CAAsB,UAAtB,EAAkC,UAACG,KAAD;EAAA,WAAkBlC,MAAM,CAAC;EAAEC,MAAAA,OAAO,EAAPA,OAAF;EAAWiC,MAAAA,KAAK,EAALA;EAAX,KAAD,CAAxB;EAAA,GAAlC;EACH;;EAED,SAASlC,MAAT;QAAkBC,gBAAAA;QAASiC,cAAAA;EACvB,MAAMC,MAAM,GAAGD,KAAK,CAACmC,aAArB;EACA,MAAMP,IAAI,GAAG3B,MAAM,CAAC6B,QAAP,IAAmBvB,IAAI,CAACsB,QAAL,CAAcC,QAA9C;EACA,MAAMhB,KAAK,GAAGL,OAAO,CAACV,GAAR,CAAYhC,OAAZ,EAAqB6D,IAArB,CAAd;EAEA5B,EAAAA,KAAK,CAACsB,cAAN;EAEAU,EAAAA,QAAQ,CAAC;EACLlB,IAAAA,KAAK,EAALA,KADK;EAELc,IAAAA,IAAI,EAAJA,IAFK;EAGLK,IAAAA,UAAU,EAAEjC,KAAK,CAACE,IAAN,KAAe;EAHtB,GAAD,CAAR;EAKA7D,EAAAA,KAAK,CACDsD,QAAQ,CAACyC,cAAT,CAAwBrE,OAAO,CAACsE,QAAR,IAAoBtE,OAAO,CAACuE,EAA5B,IAAkChC,MAA1D,CADC,EAEDQ,KAAK,CAACoB,IAAN,EAFC,CAAL;EAIH;;EAED,SAASF,QAAT;QACIlB,cAAAA;QACAc,aAAAA;QACAK,mBAAAA;EAMA,MAAMlB,KAAK,GAAGF,QAAQ,CAACC,KAAD,CAAR,IAAmBP,IAAI,CAACZ,QAAL,CAAcoB,KAA/C;;EAEA,MAAI,CAACkB,UAAL,EAAiB;EACb1B,IAAAA,IAAI,CAACgC,OAAL,CAAaC,SAAb,CAAuB,EAAvB,EAA2BzB,KAA3B,EAAkCa,IAAlC;EACH;;EAEDrB,EAAAA,IAAI,CAACZ,QAAL,CAAcoB,KAAd,GAAsBA,KAAtB;EACH;;;EAGD,SAAS0B,QAAT,CAAkBC,GAAlB,EAA+Bd,IAA/B;EACI,MAAIe,OAAJ;EAEA,MAAMC,YAAY,GAAG,UAArB;EACA,MAAMC,UAAU,GAAG,EAAnB;;EAEA,SAAQF,OAAO,GAAGf,IAAI,CAACd,KAAL,CAAW8B,YAAX,CAAlB,EAA6C;EACzChB,IAAAA,IAAI,GAAGA,IAAI,CAACxC,OAAL,CAAawD,YAAb,EAA2B,UAA3B,CAAP;EAEAC,IAAAA,UAAU,CAACC,IAAX,CAAgBH,OAAO,CAAC,CAAD,CAAvB;EACH;;EAED,MAAMI,OAAO,GAAG,IAAIC,MAAJ,OAAepB,IAAf,kBAAkC,GAAlC,CAAhB;EACA,MAAMd,KAAK,GAAG4B,GAAG,CAAC5B,KAAJ,CAAUiC,OAAV,CAAd;;EAEA,MAAIjC,KAAJ,EAAW;EACP,WAAO+B,UAAU,CAACI,MAAX,CAAkB,UAACC,GAAD,EAAaC,KAAb,EAA4BC,KAA5B;EACrBF,MAAAA,GAAG,CAACC,KAAD,CAAH,GAAarC,KAAK,CAACsC,KAAK,GAAG,CAAT,CAAlB;EAEA,aAAOF,GAAP;EACH,KAJM,EAIJ,EAJI,CAAP;EAKH;EACJ;;EAED,SAASxC,YAAT;EACI,MAAM2C,YAAY,GAAG,IAAInG,GAAJ,EAArB;;EACA,MAAMvC,IAAI,GAAG,SAAPA,IAAO,KAAb;;EAEA,SAAO;EACHoF,IAAAA,GADG,eACChC,OADD,EACyB2E,GADzB;EAEC,UAAI,CAACW,YAAY,CAAC3D,GAAb,CAAiBgD,GAAjB,CAAL,EAA4B;EACxB,YAAIY,IAAI,GAAG,EAAX;EACA,YAAI1C,MAAJ;EAEA,YAAM2C,aAAa,GAAGxF,OAAO,CAAC4D,MAA9B;EACA,YAAM6B,MAAM,GAAG7F,MAAM,CAACC,IAAP,CAAY2F,aAAZ,CAAf;EACA,YAAM1F,MAAM,GAAG2F,MAAM,CAAC3F,MAAtB;;EAEA,aAAK,IAAImB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,MAApB,EAA4BmB,CAAC,GAAGA,CAAC,GAAG,CAApC,EAAuC;EACnCsE,UAAAA,IAAI,GAAGE,MAAM,CAACxE,CAAD,CAAb;EACA4B,UAAAA,MAAM,GAAG6B,QAAQ,CAACC,GAAD,EAAMc,MAAM,CAACxE,CAAD,CAAZ,CAAjB;;EAEA,cAAI4B,MAAJ,EAAY;EACR;EACH;EACJ;;EAED,YAAM6C,IAAI,GAAGF,aAAa,CAACD,IAAD,CAA1B;EAEAD,QAAAA,YAAY,CAACtD,GAAb,CAAiB2C,GAAjB,EAAsB;EAClB9B,UAAAA,MAAM,EAANA,MADkB;EAElBG,UAAAA,KAAK,EAAE0C,IAAI,CAAC1C,KAAL,IAAcpG,IAFH;EAGlBuH,UAAAA,IAAI,EAAEuB,IAAI,CAACvB,IAAL,IAAavH;EAHD,SAAtB;EAKH;;EAED,aAAO0I,YAAY,CAAC5D,GAAb,CAAiBiD,GAAjB,CAAP;EACH;EA7BE,GAAP;EA+BH;;WC/JegB,IAAI3F;;;EAChB,MAAM4F,MAAM,GAAG5F,OAAO,CAAC4D,MAAR,IAAkBA,MAAM,CAAC5D,OAAD,CAAvC;EACA,MAAMmE,IAAI,GAAIyB,MAAM,IAAIA,MAAM,CAACzB,IAAlB,IAA2BnE,OAAO,CAACmE,IAAhD;EACA,MAAM0B,QAAQ,GAAG,IAAIC,gBAAJ,EAAjB;EACA,MAAMC,aAAa,GAAGnE,QAAQ,CAACwB,aAAT,CAAuB,KAAvB,CAAtB;EACA,MAAM4C,YAAY,GAAGpE,QAAQ,CAACyC,cAAT,CAAwBrE,OAAO,CAACuE,EAAR,IAAchC,MAAtC,CAArB;EAEA,MAAIyD,YAAJ,aAAIA,YAAJ,uBAAIA,YAAY,CAAEC,YAAd,CAA2B,WAA3B,CAAJ,EAA6C;EAE7CJ,EAAAA,QAAQ,CAACK,WAAT,CAAqBH,aAArB;EACAzH,EAAAA,KAAK,CAAEuH,QAAQ,CAACM,aAAT,CAAuB,KAAvB,CAAF,EAAwDhC,IAAI,EAA5D,CAAL;EACA6B,EAAAA,YAAY,SAAZ,IAAAA,YAAY,WAAZ,qCAAAA,YAAY,CAAEI,UAAd,gFAA0BC,YAA1B,CAAuCN,aAAvC,EAAsDC,YAAtD;EACH;;ECJD,IAAMrJ,UAAQ,gBAAGF,SAAS,EAA1B;AAEA,WAAgB6J;QACZC,aAAAA;QACAC,gBAAAA;QACApG,WAAAA;QACAqG,gBAAAA;QACAC,gBAAAA;QACA3G,cAAAA;;EAEA,MAAMnD,IAAI,GAAG,SAAPA,IAAO,KAAb;;EACA,MAAMiD,IAAI,GAAG,IAAI8G,GAAJ,EAAb;EAEA,MAAI1G,OAAJ;EACA,MAAI2G,QAAO,GAA+BhK,IAA1C;EACA,MAAIiK,QAAO,GAA+BjK,IAA1C;EACA,MAAIkK,KAAK,GAAU,EAAnB;;EAEA,MAAMC,OAAM,GAAG,SAATA,MAAS,CAACC,WAAD;EACX,WAAO,UAAIC,YAAJ;EACH,UAAMC,iBAAiB,GAAGF,WAA1B;;EACA,UAAMG,QAAQ,GAAG,SAAXA,QAAW,CAACC,QAAD;EACbzK,QAAAA,UAAQ,CAAC;EACL4J,UAAAA,KAAK,CAACvE,GAAN,CAAUkF,iBAAV,EAA6BE,QAA7B;EACA9I,UAAAA,KAAK,CAAC2B,OAAD,EAAUoH,aAAa,CAACP,KAAD,CAAvB,CAAL;EACH,SAHO,CAAR;EAIH,OALD;;EAOA,UAAI,CAACP,KAAK,CAAC5E,GAAN,CAAUqF,WAAV,CAAL,EAA6B;EACzBT,QAAAA,KAAK,CAACvE,GAAN,CAAUgF,WAAV,EAAuBC,YAAvB;EACApH,QAAAA,IAAI,CAACyH,GAAL,CAASN,WAAT;EACH;;EAED,aAAO,CAACT,KAAK,CAAC7E,GAAN,CAAUsF,WAAV,CAAD,EAAyBG,QAAzB,CAAP;EACH,KAfD;EAgBH,GAjBD;;EAmBA,MAAMI,QAAO,GAAG,SAAVA,OAAU,CAACP,WAAD;EACZ,WAAO,UAAC/K,QAAD,EAAuBuL,QAAvB;EACH,UAAMC,SAAS,GAAG,CAACD,QAAnB;EACA,UAAME,IAAI,GAAGnB,KAAK,CAAC7E,GAAN,CAAUsF,WAAV,CAAb;EACA,UAAMW,cAAc,GAAGD,IAAI,GACrB,CAACF,QAAQ,CAACI,KAAT,CAAe,UAAClC,IAAD,EAAOzE,CAAP;EACZ,eAAO4G,IAAI,CAACC,SAAL,CAAepC,IAAf,MAAyBmC,IAAI,CAACC,SAAL,CAAeJ,IAAI,CAACzG,CAAD,CAAnB,CAAhC;EACH,OAFA,CADoB,GAIrB,IAJN;;EAMA,UAAIwG,SAAS,IAAIE,cAAjB,EAAiC;EAC7BhL,QAAAA,UAAQ,CAAC;EACL4J,UAAAA,KAAK,CAACvE,GAAN,CAAUgF,WAAV,EAAuBQ,QAAvB;EACA3H,UAAAA,IAAI,CAACyH,GAAL,CAASN,WAAT;EACA/K,UAAAA,QAAQ;EACX,SAJO,CAAR;EAKH;EACJ,KAhBD;EAiBH,GAlBD;;EAoBA,MAAMoL,aAAa,GAAG,SAAhBA,aAAgB,CAACU,SAAD;EAClB,QAAIf,WAAW,GAAG,CAAlB;EAEAF,IAAAA,KAAK,GAAGiB,SAAS,IAAI,EAArB;EAEA,QAAMC,QAAQ,GAAGjI,MAAM,CAAC;EACpB6G,MAAAA,OAAO,EAAE,iBAAC3K,QAAD;EACL,eAAQ2K,QAAO,GAAG3K,QAAQ,IAAI2K,QAA9B;EACH,OAHmB;EAIpBC,MAAAA,OAAO,EAAE,iBAAC5K,QAAD;EACL,eAAQ4K,QAAO,GAAG5K,QAAQ,IAAI4K,QAA9B;EACH,OANmB;EAOpBU,MAAAA,OAAO,EAAE,iBAACtL,QAAD,EAAuByL,IAAvB;EACL,eAAOH,QAAO,cAAYnH,GAAZ,SAAmB4G,WAAW,EAA9B,CAAP,CAA2C/K,QAA3C,EAAqDyL,IAArD,CAAP;EACH,OATmB;EAUpBtH,MAAAA,GAAG,EAAHA,GAVoB;EAWpB0G,MAAAA,KAAK,EAALA,KAXoB;EAYpBC,MAAAA,MAAM,EAAE,gBAACE,YAAD;EACJ,eAAOF,OAAM,aAAW3G,GAAX,SAAkB4G,WAAW,EAA7B,CAAN,CAAyCC,YAAzC,CAAP;EACH;EAdmB,KAAD,CAAvB;;EAiBA,QAAIe,QAAQ,KAAK,IAAjB,EAAuB;EACnB,aAAO;EACH,eAAO,IAAP;EACH,OAFD;EAGH;;EAED,WAAO,SAASC,eAAT;EACHhI,MAAAA,OAAO,GAAG+H,QAAQ,CAAC;EACf5H,QAAAA,GAAG,EAAHA,GADe;EAEfF,QAAAA,eAAe,EAAE;EACb,cAAM7D,CAAC,GAAG4D,OAAV;EAEA5D,UAAAA,CAAC,CAAC6L,OAAF,GAAYrI,IAAZ;EACAxD,UAAAA,CAAC,CAAC8L,SAAF,GAActB,QAAd;;EAEA,cAAIC,KAAK,CAAC3C,IAAV,EAAgB;EACZ9H,YAAAA,CAAC,CAAC+L,OAAF,CAAUjE,IAAV,GAAiB2C,KAAK,CAAC3C,IAAvB;EACH;;EAEDyC,UAAAA,QAAO,CAAC3G,OAAD,CAAP;;EACAwG,UAAAA,QAAQ,CAACrG,GAAD,EAAMH,OAAN,CAAR;EACH,SAdc;EAefE,QAAAA,eAAe,EAAE;EACbuG,UAAAA,QAAQ,CAACtG,GAAD,EAAMH,OAAN,CAAR;EACH;EAjBc,OAAD,CAAlB;EAoBA,aAAOA,OAAP;EACH,KAtBD;EAuBH,GAnDD;;EAqDA,SAAOoH,aAAa,CAACb,QAAD,CAApB;EACH;;ECzHD,IAAI6B,UAAU,GAAG,CAAjB;;EAEA,IAAMC,YAAY,GAAG,SAAfA,YAAe;EACjB,gBAAYD,UAAU,EAAtB;EACH,CAFD;;EAIA,IAAME,QAAQ,gBAAG,IAAIpJ,GAAJ,EAAjB;EACA,IAAMqJ,QAAQ,gBAAG,IAAIrJ,GAAJ,EAAjB;EACA,IAAMoH,KAAK,gBAAG,IAAIpH,GAAJ,EAAd;;EAEA,IAAMuH,QAAQ,GAAG,SAAXA,QAAW,CAACtG,GAAD;EACb,GAACmI,QAAQ,CAAC7G,GAAT,CAAatB,GAAb,KAAqB,EAAtB,EAA0BvB,OAA1B,CAAkC,UAAC4J,CAAD;EAC9B,QAAMC,gBAAgB,GAAGF,QAAQ,CAAC9G,GAAT,CAAa+G,CAAb,CAAzB;;EAEA,QAAIC,gBAAJ,EAAsB;EAClBA,MAAAA,gBAAgB,CAACP,SAAjB,CAA2BO,gBAA3B;;EACAA,MAAAA,gBAAgB,CAACR,OAAjB,CAAyBrJ,OAAzB,CAAiC,UAACQ,CAAD;EAAA,eAAekH,KAAK,UAAL,CAAalH,CAAb,CAAf;EAAA,OAAjC;EACH;;EAEDkJ,IAAAA,QAAQ,UAAR,CAAgBE,CAAhB;EACAD,IAAAA,QAAQ,UAAR,CAAgBC,CAAhB;EACH,GAVD;EAWH,CAZD;;EAcA,IAAME,WAAW,GAAG,SAAdA,WAAc,CAAC1I,OAAD,EAAmBG,GAAnB;EAChB;EACAoI,EAAAA,QAAQ,CAAC3J,OAAT,CAAiB,UAAChC,CAAD,EAAI4L,CAAJ;EACb,QAAMG,UAAU,GAAGJ,QAAQ,CAAC9G,GAAT,CAAa+G,CAAb,CAAnB;;EAEA,QAAIG,UAAU,IAAIA,UAAU,CAACL,QAAX,CAAoBtI,OAApB,CAAlB,EAAgD;EAC5CsI,MAAAA,QAAQ,CAACvG,GAAT,CAAayG,CAAb,YAAqBF,QAAQ,CAAC7G,GAAT,CAAa+G,CAAb,KAAmB,EAAxC,GAA6CrI,GAA7C;EACH;EACJ,GAND;EAOH,CATD;;EAWA,IAAMqG,QAAQ,GAAG,SAAXA,QAAW,CAACrG,GAAD,EAAcH,OAAd;EACbuI,EAAAA,QAAQ,CAACxG,GAAT,CAAa5B,GAAb,EAAkBH,OAAlB;EACA0I,EAAAA,WAAW,CAAC1I,OAAD,EAAUG,GAAV,CAAX;EACH,CAHD;;AAKA,WAAgByI,UAAU9I;EACtB,WAAS+I,OAAT,CAAiB1I,GAAjB,EAA8BoG,QAA9B;EACI,QAAMuC,IAAI,GAAGvC,QAAQ,IAAIA,QAAQ,CAACpG,GAArB,GAA2BoG,QAAQ,CAACpG,GAAT,GAAeA,GAA1C,GAAgDA,GAA7D;;EAEA,WAAOkG,gBAAgB,CAAC;EACpBC,MAAAA,KAAK,EAALA,KADoB;EAEpBnG,MAAAA,GAAG,EAAE2I,IAFe;EAGpBvC,MAAAA,QAAQ,EAAEA,QAAQ,IAAI,EAHF;EAIpBC,MAAAA,QAAQ,EAARA,QAJoB;EAKpBC,MAAAA,QAAQ,EAARA,QALoB;EAMpB3G,MAAAA,MAAM,EAANA;EANoB,KAAD,CAAvB;EAQH;;EAED,WAASiJ,IAAT;EACI,WAAOF,OAAO,CAACG,IAAR,CAAa,IAAb,EAAmBX,YAAY,EAA/B,CAAP;EACH;;EAED,SAAOU,IAAP;EACH;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}