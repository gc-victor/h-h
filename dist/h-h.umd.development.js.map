{"version":3,"file":"h-h.umd.development.js","sources":["../src/quicktask.ts","../src/dom/dom.incremental-dom.ts","../src/dom/dom.hyperscript.ts","../src/app/app.constants.ts","../src/router/router.root.ts","../src/router/router.ts","../src/app/app.ts","../src/component/component.factory.ts","../src/component/component.ts"],"sourcesContent":["// https://github.com/staltz/quicktask/blob/master/index.ts\n// https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/queueMicrotask#When_queueMicrotask_isnt_available\n// https://morioh.com/p/4ca3c63dbc0c\nconst getGlobal = () => {\n    if (typeof globalThis !== 'undefined') return globalThis;\n    // eslint-disable-next-line\n    if (typeof self !== 'undefined') return self;\n    if (typeof window !== 'undefined') return window;\n    if (typeof global !== 'undefined') return global;\n    throw new Error('Unable to locate global object');\n};\n\nconst globalThis: any = getGlobal();\n\nif (typeof globalThis.queueMicrotask !== 'function') {\n    globalThis.queueMicrotask = function queueMicrotask(callback: any) {\n        if (globalThis.Promise) {\n            Promise.resolve()\n                .then(callback)\n                .catch((e) =>\n                    setTimeout(() => {\n                        throw e;\n                    })\n                );\n        } else if (typeof process !== 'undefined') {\n            return process.nextTick(callback);\n        } else {\n            return setTimeout(callback);\n        }\n    };\n}\n\nexport function quicktask() {\n    return (fn: (arg?: any) => void) => globalThis.queueMicrotask(fn);\n}\n","import { HyperScriptNode } from './dom.types';\nimport { quicktask } from '../quicktask';\n\nconst schedule = quicktask();\nconst noop = (_?: unknown) => {};\nconst {\n    attr,\n    attributes = {},\n    elementClose,\n    elementOpenEnd,\n    elementOpenStart,\n    notifications = {\n        nodesCreated: noop,\n        nodesDeleted: noop,\n    },\n    patchOuter,\n    renderToString = noop,\n    skip = noop,\n    skipNode = noop,\n    text,\n    // @ts-ignore\n} = IncrementalDOM;\n\n// @see https://github.com/davidjamesstone/superviews.js/issues/32#issuecomment-274372713\nexport const attributesIDom = attributes || {};\nexport const attrIDom = attr;\nexport const elementCloseIDom = elementClose;\nexport const elementOpenEndIDom = elementOpenEnd;\nexport const elementOpenStartIDom = elementOpenStart;\nexport const notificationsIDom = notifications;\nexport const renderToStringIDom = renderToString;\nexport const textIDom = text;\nexport const skipIDom = skip;\nexport const skipNodeIDom = skipNode;\nexport const patch = (node: Element, fn: (data: unknown) => void) => {\n    return schedule(() => {\n        return patchOuter(node, fn);\n    });\n};\n\nattributesIDom.value = (el: HTMLFormElement, _name: string, value: any) => {\n    return (el.value = value === null || typeof value === 'undefined' ? '' : value);\n};\n\nattributesIDom.checked = (el: HTMLFormElement, _name: string, value: any) => {\n    return (el.checked = !!value);\n};\n\nnotificationsIDom.nodesDeleted = (nodes: HyperScriptNode[]) =>\n    nodes.forEach(\n        (node) => node && node._elementDetached && schedule(node._elementDetached as () => void)\n    );\n\nnotificationsIDom.nodesCreated = (nodes: HyperScriptNode[]) =>\n    nodes.forEach(\n        (node) => node && node._elementAttached && schedule(node._elementAttached as () => void)\n    );\n","import {\n    attrIDom,\n    elementCloseIDom,\n    elementOpenEndIDom,\n    elementOpenStartIDom,\n    skipIDom,\n    textIDom,\n} from './dom.incremental-dom';\nimport { HTMLElements, HTMLElementsAttributes, HyperScriptNode } from './dom.types';\n\nconst handlersCache = new WeakMap();\nconst eventTypes = new Map();\n\nexport function h<T extends HTMLElements>(\n    tagName: T,\n    attributes: HTMLElementsAttributes[T],\n    children: any[]\n) {\n    const attrs = attributes || {};\n    const outerArgs = arguments;\n    const names = Object.keys(attrs);\n    const length = names.length;\n\n    function render(\n        options: {\n            skip: boolean;\n            key?: string;\n            elementAttached?: Function;\n            elementDetached?: Function;\n        } = { skip: false }\n    ) {\n        let element;\n\n        const elementAttached = attrs.elementAttached || options.elementAttached;\n        const elementDetached = attrs.elementDetached || options.elementDetached;\n        const key = attrs.key || options.key || null;\n        const skip = attrs.skip || options.skip || null;\n\n        elementOpenStartIDom(tagName, key);\n        setAttributes({ attributes: attrs, names, length });\n        elementOpenEndIDom();\n\n        if (skip) {\n            skipIDom();\n\n            element = elementCloseIDom(tagName);\n        } else {\n            if (Array.isArray(children)) {\n                children.forEach(renderChildren);\n            } else {\n                forEachChildInArgs(outerArgs, renderChildren);\n            }\n\n            element = elementCloseIDom(tagName) || {};\n\n            element._elementAttached = elementAttached;\n            element._elementDetached = elementDetached;\n\n            if (typeof window !== 'undefined') {\n                setEvents({ attributes: attrs, names, length, element });\n            }\n\n            if (typeof attrs.ref === 'function') {\n                attrs.ref(element);\n            }\n        }\n\n        return element;\n    }\n\n    return render;\n}\n\nfunction isEvent(name: string): boolean {\n    return /^on/.test(name);\n}\n\nfunction isSkip(name: string): boolean {\n    return /^skip$/.test(name);\n}\n\nfunction isRef(name: string): boolean {\n    return /^ref$/.test(name);\n}\n\nfunction setAttributes({\n    attributes,\n    names,\n    length,\n}: {\n    attributes: any;\n    names: Array<string>;\n    length: number;\n}): void {\n    for (let i = 0; i < length; i++) {\n        const name = names[i];\n\n        if (name && !isEvent(name) && !isSkip(name) && !isRef(name)) {\n            const classProp = name === 'className' ? 'class' : '';\n            const forProp = name === 'htmlFor' ? 'for' : '';\n            // @see: https://github.com/shahata/dasherize/blob/master/index.js#L26\n            const hyphenated = name.replace(\n                /[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,\n                function (s: string, j: number) {\n                    return (j > 0 ? '-' : '') + s.toLowerCase();\n                }\n            );\n\n            attrIDom(forProp || classProp || hyphenated, attributes[name]);\n        }\n    }\n}\n\nfunction setEvents({\n    attributes,\n    names,\n    length,\n    element,\n}: {\n    attributes: any;\n    names: Array<string>;\n    length: number;\n    element: HyperScriptNode;\n}): void {\n    for (let i = 0; i < length; i++) {\n        const name = names[i];\n\n        if (name && isEvent(name)) {\n            const eventName = name.toLowerCase().substring(2);\n            const handlers = handlersCache.get(element) || {};\n\n            if (!eventTypes.has(eventName)) {\n                document.body.addEventListener(eventName, eventProxy, false);\n            }\n\n            eventTypes.set(eventName, 1);\n            handlersCache.set(element, { ...handlers, [eventName]: attributes[name] });\n        }\n    }\n}\n\nfunction eventProxy(event: Event) {\n    const element = event.target as any;\n    const handlers = handlersCache.get(element) || {};\n    const type = event.type;\n\n    if (handlers[type]) {\n        return handlers[type](event);\n    }\n}\n\nfunction forEachChildInArgs(args: IArguments, iteratee: Function) {\n    if (args.length > 2) {\n        for (let i = 2; i < args.length; i++) {\n            iteratee(args[i]);\n        }\n    }\n}\n\nfunction renderChildren(children: Function | string | void) {\n    const str = typeof children === 'string' ? textIDom(children) : '';\n\n    return typeof children === 'function' ? children() : str;\n}\n","export const APP_ID = 'app';\n","// @see: https://github.com/purposeindustries/window-or-global/\nexport const root: any =\n    // eslint-disable-next-line\n    (typeof self === 'object' && self.self === self && self) ||\n    // @ts-ignore\n    (typeof global === 'object' && global.global === global && global) ||\n    window;\n","import { APP_ID } from '../app/app.constants';\nimport { View } from '../app/app.types';\nimport { patch } from '../dom';\nimport { root } from './router.root';\nimport { Params, RouterOptions } from './router.types';\n\ninterface Model {\n    [key: string]: any;\n}\n\ninterface Match {\n    params: Params;\n    title: (params: Params) => string;\n    view: View;\n}\n\ninterface SetMatcher {\n    set: (options: RouterOptions, path: string) => Match;\n}\n\nlet setClick: (link: HTMLAnchorElement) => void;\n\nconst matcher = storeMatcher();\nconst getParams = ({ params }: Match) => params;\nconst getTitle = (match: Match): string => match.title(getParams(match));\n\nexport const redirect = (href: string) => {\n    const link = root.document.createElement('a');\n\n    link.setAttribute('href', href);\n    setClick(link);\n};\nexport const to = (event: Event) => {\n    const link = event.target as HTMLAnchorElement;\n\n    event.preventDefault();\n\n    setClick(link);\n};\n\nconst initClick = (options: RouterOptions) => (link: HTMLAnchorElement) => {\n    const handler = (event: Event) => {\n        link.removeEventListener('click', handler);\n        render({ options, event });\n    };\n\n    link.addEventListener('click', handler);\n    link.click();\n};\n\nexport function router(options: RouterOptions) {\n    const path = root.location.pathname;\n    const match = matcher.set(options, path);\n\n    setClick = initClick(options);\n\n    popState(options);\n    setTitle({ match, path, isPopState: false });\n\n    return {\n        view: match.view || options.view,\n    };\n}\n\nfunction popState(options: RouterOptions) {\n    root.addEventListener('popstate', (event: Event) => render({ options, event }));\n}\n\nfunction render({ options, event }: { options: RouterOptions; event: Event }): void {\n    const target = event.currentTarget as HTMLAnchorElement;\n    const path = target.pathname || root.location.pathname;\n    const match = matcher.set(options, path);\n\n    event.preventDefault();\n\n    setTitle({\n        match,\n        path,\n        isPopState: event.type === 'popstate',\n    });\n    patch(\n        document.getElementById(options.routerId || options.id || APP_ID) as Element,\n        match.view()\n    );\n}\n\nfunction setTitle({\n    match,\n    path,\n    isPopState,\n}: {\n    match: Match;\n    path: string;\n    isPopState: boolean;\n}): void {\n    const title = getTitle(match) || root.document.title;\n\n    if (!isPopState) {\n        root.history.pushState({}, title, path);\n    }\n\n    root.document.title = title;\n}\n\n// @see https://github.com/jesseditson/fs-router/blob/v0.2.0/index.js#L7\nfunction addMatch(url: string, path: string) {\n    let matched;\n\n    const paramPattern = /:([^/]+)/;\n    const paramNames = [] as Array<any>;\n\n    while ((matched = path.match(paramPattern))) {\n        path = path.replace(paramPattern, '([^?/]+)');\n\n        paramNames.push(matched[1] as never);\n    }\n\n    const pattern = new RegExp(`^${path}(\\\\?(.*)|$)`, 'i');\n    const match = url.match(pattern);\n\n    if (match) {\n        return paramNames.reduce((map: Model, param: string, index: number) => {\n            map[param] = match[index + 1];\n\n            return map;\n        }, {});\n    }\n}\n\nfunction storeMatcher(): SetMatcher {\n    const storeMatches = new Map();\n    const noop = () => {};\n\n    return {\n        set(options: RouterOptions, url: string): Match {\n            if (!storeMatches.has(url)) {\n                let rout = '';\n                let params;\n\n                const optionsRouter = options.router;\n                const routes = Object.keys(optionsRouter);\n                const length = routes.length;\n\n                for (let i = 0; i < length; i = i + 1) {\n                    rout = routes[i];\n                    params = addMatch(url, routes[i]);\n\n                    if (params) {\n                        break;\n                    }\n                }\n\n                const item = optionsRouter[rout];\n\n                storeMatches.set(url, {\n                    params,\n                    title: item.title || noop,\n                    view: item.view || noop,\n                });\n            }\n\n            return storeMatches.get(url);\n        },\n    };\n}\n","import { patch } from '../dom';\nimport { RouterOptions, router } from '../router';\nimport { App } from './app.types';\nimport { APP_ID } from './app.constants';\n\nexport function app(options: App) {\n    const plugin = options.router && router(options as RouterOptions);\n    const view = (plugin && plugin.view) || options.view;\n    const fragment = new DocumentFragment();\n    const tempContainer = document.createElement('div');\n    const appContainer = document.getElementById(options.id || APP_ID);\n\n    if (appContainer?.hasAttribute('data-skip')) return;\n\n    fragment.appendChild(tempContainer);\n    patch((fragment.querySelector('div') as unknown) as Element, view());\n    appContainer?.parentNode?.replaceChild(tempContainer, appContainer as Element);\n}\n","import { patch } from '../dom';\nimport { Props, Render, UpdateResponse } from './component.types';\nimport { quicktask } from '../quicktask';\n\ninterface ComponentFactory {\n    hooks: any;\n    key: string;\n    onCreate: (key: string, element: Element) => void;\n    onDelete: (key: string, element: Element) => void;\n    render: Render;\n    newProps: Props;\n}\n\nconst schedule = quicktask();\n\nexport function componentFactory({\n    hooks,\n    newProps,\n    key,\n    onCreate,\n    onDelete,\n    render,\n}: ComponentFactory) {\n    const noop = () => {};\n    const keys = new Set();\n\n    let element: Element;\n    let created: (element: Element) => void = noop;\n    let deleted: (element: Element) => void = noop;\n    let props: Props = {};\n\n    const update = (currentHook: string) => {\n        return <S>(initialState: S): UpdateResponse<S> => {\n            const setStateHookIndex = currentHook;\n            const setState = (newState: S) => {\n                schedule(() => {\n                    hooks.set(setStateHookIndex, newState);\n                    patch(element, renderElement(props));\n                });\n            };\n\n            if (!hooks.has(currentHook)) {\n                hooks.set(currentHook, initialState);\n                keys.add(currentHook);\n            }\n\n            return [hooks.get(currentHook), setState];\n        };\n    };\n\n    const execute = (currentHook: string) => {\n        return (callback: () => void, depArray: any[]) => {\n            const hasNoDeps = !depArray;\n            const deps = hooks.get(currentHook);\n            const hasChangedDeps = deps\n                ? !depArray.every((item, i) => {\n                      return JSON.stringify(item) === JSON.stringify(deps[i]);\n                  })\n                : true;\n\n            if (hasNoDeps || hasChangedDeps) {\n                schedule(() => {\n                    hooks.set(currentHook, depArray);\n                    keys.add(currentHook);\n                    callback();\n                });\n            }\n        };\n    };\n\n    const renderElement = (nextProps?: Props): (() => Element | null) => {\n        let currentHook = 0;\n\n        props = nextProps || {};\n\n        const reRender = render({\n            created: (callback: (element: Element) => void) => {\n                return (created = callback || created);\n            },\n            deleted: (callback: (element: Element) => void) => {\n                return (deleted = callback || deleted);\n            },\n            execute: (callback: () => void, deps: any[]) => {\n                return execute(`execute-${key}-${currentHook++}`)(callback, deps);\n            },\n            key,\n            props,\n            update: (initialState) => {\n                return update(`update-${key}-${currentHook++}`)(initialState);\n            },\n        });\n\n        if (reRender === null) {\n            return () => {\n                return null;\n            };\n        }\n\n        return function elementCallback() {\n            element = reRender({\n                key,\n                elementAttached: () => {\n                    const e = element as any;\n\n                    e.__hooks = keys;\n                    e.__deleted = deleted;\n\n                    if (props.view) {\n                        e.dataset.view = props.view;\n                    }\n\n                    created(element);\n                    onCreate(key, element);\n                },\n                elementDetached: () => {\n                    onDelete(key, element);\n                },\n            });\n\n            return element;\n        };\n    };\n\n    return renderElement(newProps);\n}\n","import { componentFactory } from './component.factory';\nimport { Props, Render } from './component.types';\n\nlet keyCounter = 1;\n\nconst keyGenerator = () => {\n    return `__${keyCounter++}__`;\n};\n\nconst contains = new Map();\nconst elements = new Map();\nconst hooks = new Map();\n\nconst onDelete = (key: string) => {\n    (contains.get(key) || []).forEach((k: string) => {\n        const containedElement = elements.get(k);\n\n        if (containedElement) {\n            containedElement.__deleted(containedElement);\n            containedElement.__hooks.forEach((h: string) => hooks.delete(h));\n        }\n\n        contains.delete(k);\n        elements.delete(k);\n    });\n};\n\nconst setChildren = (element: Element, key: string) => {\n    // Set children and itself\n    elements.forEach((_, k) => {\n        const domElement = elements.get(k);\n\n        if (domElement && domElement.contains(element)) {\n            contains.set(k, [...(contains.get(k) || []), key]);\n        }\n    });\n};\n\nconst onCreate = (key: string, element: Element) => {\n    elements.set(key, element);\n    setChildren(element, key);\n};\n\nexport function component(render: Render) {\n    function factory(key: string, newProps?: Props) {\n        const _key = newProps && newProps.key ? newProps.key + key : key;\n\n        return componentFactory({\n            hooks,\n            key: _key,\n            newProps: newProps || {},\n            onCreate,\n            onDelete,\n            render,\n        });\n    }\n\n    function init() {\n        return factory.bind(null, keyGenerator());\n    }\n\n    return init;\n}\n"],"names":["getGlobal","globalThis","self","window","global","Error","queueMicrotask","callback","Promise","resolve","then","e","setTimeout","process","nextTick","quicktask","fn","schedule","noop","_","IncrementalDOM","attr","attributes","elementClose","elementOpenEnd","elementOpenStart","notifications","nodesCreated","nodesDeleted","patchOuter","renderToString","skip","skipNode","text","attributesIDom","attrIDom","elementCloseIDom","elementOpenEndIDom","elementOpenStartIDom","notificationsIDom","renderToStringIDom","textIDom","skipIDom","skipNodeIDom","patch","node","value","el","_name","checked","nodes","forEach","_elementDetached","_elementAttached","handlersCache","WeakMap","eventTypes","Map","h","tagName","children","attrs","outerArgs","arguments","names","Object","keys","length","render","options","element","elementAttached","elementDetached","key","setAttributes","Array","isArray","renderChildren","forEachChildInArgs","setEvents","ref","isEvent","name","test","isSkip","isRef","i","classProp","forProp","hyphenated","replace","s","j","toLowerCase","eventName","substring","handlers","get","has","document","body","addEventListener","eventProxy","set","event","target","type","args","iteratee","str","APP_ID","root","setClick","matcher","storeMatcher","getParams","params","getTitle","match","title","redirect","href","link","createElement","setAttribute","to","preventDefault","initClick","handler","removeEventListener","click","router","path","location","pathname","popState","setTitle","isPopState","view","currentTarget","getElementById","routerId","id","history","pushState","addMatch","url","matched","paramPattern","paramNames","push","pattern","RegExp","reduce","map","param","index","storeMatches","rout","optionsRouter","routes","item","app","plugin","fragment","DocumentFragment","tempContainer","appContainer","hasAttribute","appendChild","querySelector","parentNode","replaceChild","componentFactory","hooks","newProps","onCreate","onDelete","Set","created","deleted","props","update","currentHook","initialState","setStateHookIndex","setState","newState","renderElement","add","execute","depArray","hasNoDeps","deps","hasChangedDeps","every","JSON","stringify","nextProps","reRender","elementCallback","__hooks","__deleted","dataset","keyCounter","keyGenerator","contains","elements","k","containedElement","setChildren","domElement","component","factory","_key","init","bind"],"mappings":"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"}