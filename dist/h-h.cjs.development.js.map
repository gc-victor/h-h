{"version":3,"file":"h-h.cjs.development.js","sources":["../src/quicktask.ts","../src/dom/dom.incremental-dom.ts","../src/dom/dom.hyperscript.ts","../src/app/app.constants.ts","../src/router/router.root.ts","../src/router/router.ts","../src/app/app.ts","../src/component/component.factory.ts","../src/component/component.ts"],"sourcesContent":["// https://github.com/staltz/quicktask/blob/master/index.ts\n// https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/queueMicrotask#When_queueMicrotask_isnt_available\n// https://morioh.com/p/4ca3c63dbc0c\nconst getGlobal = () => {\n    if (typeof globalThis !== 'undefined') return globalThis;\n    // eslint-disable-next-line\n    if (typeof self !== 'undefined') return self;\n    if (typeof window !== 'undefined') return window;\n    if (typeof global !== 'undefined') return global;\n    throw new Error('Unable to locate global object');\n};\n\nconst globalThis: any = getGlobal();\n\nif (typeof globalThis.queueMicrotask !== 'function') {\n    globalThis.queueMicrotask = function queueMicrotask(callback: any) {\n        if (globalThis.Promise) {\n            Promise.resolve()\n                .then(callback)\n                .catch((e) =>\n                    setTimeout(() => {\n                        throw e;\n                    })\n                );\n        } else if (typeof process !== 'undefined') {\n            return process.nextTick(callback);\n        } else {\n            return setTimeout(callback);\n        }\n    };\n}\n\nexport function quicktask() {\n    return (fn: (arg?: any) => void) => globalThis.queueMicrotask(fn);\n}\n","import { HyperScriptNode } from './dom.types';\nimport { quicktask } from '../quicktask';\n\nconst schedule = quicktask();\nconst noop = (_?: unknown) => {};\nconst {\n    attr,\n    attributes = {},\n    elementClose,\n    elementOpenEnd,\n    elementOpenStart,\n    notifications = {\n        nodesCreated: noop,\n        nodesDeleted: noop,\n    },\n    patchOuter,\n    renderToString = noop,\n    skip = noop,\n    skipNode = noop,\n    text,\n    // @ts-ignore\n} = IncrementalDOM;\n\n// @see https://github.com/davidjamesstone/superviews.js/issues/32#issuecomment-274372713\nexport const attributesIDom = attributes || {};\nexport const attrIDom = attr;\nexport const elementCloseIDom = elementClose;\nexport const elementOpenEndIDom = elementOpenEnd;\nexport const elementOpenStartIDom = elementOpenStart;\nexport const notificationsIDom = notifications;\nexport const renderToStringIDom = renderToString;\nexport const textIDom = text;\nexport const skipIDom = skip;\nexport const skipNodeIDom = skipNode;\nexport const patch = (node: Element, fn: (data: unknown) => void) => {\n    return schedule(() => {\n        return patchOuter(node, fn);\n    });\n};\n\nattributesIDom.value = (el: HTMLFormElement, _name: string, value: any) => {\n    return (el.value = value === null || typeof value === 'undefined' ? '' : value);\n};\n\nattributesIDom.checked = (el: HTMLFormElement, _name: string, value: any) => {\n    return (el.checked = !!value);\n};\n\nnotificationsIDom.nodesDeleted = (nodes: HyperScriptNode[]) =>\n    nodes.forEach(\n        (node) => node && node._elementDetached && schedule(node._elementDetached as () => void)\n    );\n\nnotificationsIDom.nodesCreated = (nodes: HyperScriptNode[]) =>\n    nodes.forEach(\n        (node) => node && node._elementAttached && schedule(node._elementAttached as () => void)\n    );\n","import {\n    attrIDom,\n    elementCloseIDom,\n    elementOpenEndIDom,\n    elementOpenStartIDom,\n    skipIDom,\n    textIDom,\n} from './dom.incremental-dom';\nimport { HTMLElements, HTMLElementsAttributes, HyperScriptNode } from './dom.types';\n\n// @see: https://github.com/preactjs/preact/blob/87202bd7dbcb5b94506f9388516a9c4bd289129a/compat/src/render.js#L10\nconst CAMEL_PROPS = /^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/;\n\nexport function h<T extends HTMLElements>(\n    tagName: T,\n    attributes: HTMLElementsAttributes[T],\n    children: any[]\n) {\n    const attrs = attributes || {};\n    const outerArgs = arguments;\n    const names = Object.keys(attrs);\n    const length = names.length;\n\n    function render(\n        options: {\n            skip: boolean;\n            key?: string;\n            elementAttached?: Function;\n            elementDetached?: Function;\n        } = { skip: false }\n    ) {\n        let element;\n\n        const elementAttached = attrs.elementAttached || options.elementAttached;\n        const elementDetached = attrs.elementDetached || options.elementDetached;\n        const key = attrs.key || options.key || null;\n        const skip = attrs.skip || options.skip || null;\n\n        elementOpenStartIDom(tagName, key);\n        setAttributes({ attributes: attrs, names, length });\n        elementOpenEndIDom();\n\n        if (skip) {\n            skipIDom();\n\n            element = elementCloseIDom(tagName);\n        } else {\n            if (Array.isArray(children)) {\n                children.forEach(renderChildren);\n            } else {\n                forEachChildInArgs(outerArgs, renderChildren);\n            }\n\n            element = elementCloseIDom(tagName) || {};\n\n            element._elementAttached = elementAttached;\n            element._elementDetached = elementDetached;\n\n            if (typeof window !== 'undefined') {\n                setEvents({ attributes: attrs, names, length, element });\n            }\n\n            if (typeof attrs.ref === 'function') {\n                attrs.ref(element);\n            }\n        }\n\n        return element;\n    }\n\n    return render;\n}\n\nfunction isEvent(name: string): boolean {\n    return /^on/.test(name);\n}\n\nfunction isSkip(name: string): boolean {\n    return /^skip$/.test(name);\n}\n\nfunction isRef(name: string): boolean {\n    return /^ref$/.test(name);\n}\n\nfunction setAttributes({\n    attributes,\n    names,\n    length,\n}: {\n    attributes: any;\n    names: Array<string>;\n    length: number;\n}): void {\n    for (let i = 0; i < length; i++) {\n        const name = names[i];\n\n        if (name && !isEvent(name) && !isSkip(name) && !isRef(name)) {\n            const classProp = name === 'className' ? 'class' : '';\n            const forProp = name === 'htmlFor' ? 'for' : '';\n            // @see: https://github.com/preactjs/preact/blob/87202bd7dbcb5b94506f9388516a9c4bd289129a/compat/src/render.js#L149\n            const hyphenated =\n                CAMEL_PROPS.test(name) && name.replace(/[A-Z0-9]/, '-$&').toLowerCase();\n\n            attrIDom(forProp || classProp || hyphenated || name, attributes[name]);\n        }\n    }\n}\n\nfunction setEvents({\n    attributes,\n    names,\n    length,\n    element,\n}: {\n    attributes: any;\n    names: Array<string>;\n    length: number;\n    element: HyperScriptNode;\n}): void {\n    for (let i = 0; i < length; i++) {\n        const name = names[i];\n\n        if (name && isEvent(name)) {\n            const eventName = name.toLowerCase().substring(2);\n\n            element._listeners = element._listeners || {};\n\n            if (!element._listeners[eventName]) {\n                element.addEventListener(eventName, eventProxy, false);\n            }\n\n            element._listeners[eventName] = attributes[name];\n        }\n    }\n}\n\nfunction eventProxy(event: Event) {\n    return (event.currentTarget as HyperScriptNode)._listeners[event.type](event);\n}\n\nfunction forEachChildInArgs(args: IArguments, iteratee: Function) {\n    if (args.length > 2) {\n        for (let i = 2; i < args.length; i++) {\n            iteratee(args[i]);\n        }\n    }\n}\n\nfunction renderChildren(children: Function | string | void) {\n    const str = typeof children === 'string' ? textIDom(children) : '';\n\n    return typeof children === 'function' ? children() : str;\n}\n","export const APP_ID = 'app';\n","// @see: https://github.com/purposeindustries/window-or-global/\nexport const root: any =\n    // eslint-disable-next-line\n    (typeof self === 'object' && self.self === self && self) ||\n    // @ts-ignore\n    (typeof global === 'object' && global.global === global && global) ||\n    window;\n","import { APP_ID } from '../app/app.constants';\nimport { View } from '../app/app.types';\nimport { patch } from '../dom';\nimport { root } from './router.root';\nimport { Params, RouterOptions } from './router.types';\n\ninterface Model {\n    [key: string]: any;\n}\n\ninterface Match {\n    params: Params;\n    title: (params: Params) => string;\n    view: View;\n}\n\ninterface SetMatcher {\n    set: (options: RouterOptions, path: string) => Match;\n}\n\nlet setClick: (link: HTMLAnchorElement) => void;\n\nconst matcher = storeMatcher();\nconst getParams = ({ params }: Match) => params;\nconst getTitle = (match: Match): string => match.title(getParams(match));\n\nexport const redirect = (href: string) => {\n    const link = root.document.createElement('a');\n\n    link.setAttribute('href', href);\n    setClick(link);\n};\nexport const to = (event: Event) => {\n    const link = event.currentTarget as HTMLAnchorElement;\n\n    event.preventDefault();\n\n    setClick(link);\n};\n\nconst initClick = (options: RouterOptions) => (link: HTMLAnchorElement) => {\n    const handler = (event: Event) => {\n        link.removeEventListener('click', handler);\n        render({ options, event });\n    };\n\n    link.addEventListener('click', handler);\n    link.click();\n};\n\nexport function router(options: RouterOptions) {\n    const match = matcher.set(options, root.location.pathname);\n\n    setClick = initClick(options);\n\n    popState(options);\n    setTitle({ match, path: setPath(root.location), isPopState: false });\n\n    return {\n        view: match.view || options.view,\n    };\n}\n\nfunction popState(options: RouterOptions) {\n    root.addEventListener('popstate', (event: Event) => render({ options, event }));\n}\n\nfunction render({ options, event }: { options: RouterOptions; event: Event }): void {\n    const target = event.currentTarget as HTMLAnchorElement;\n    const match = matcher.set(options, root.location.pathname);\n\n    event.preventDefault();\n\n    setTitle({\n        match,\n        path: setPath(target) || setPath(location),\n        isPopState: event.type === 'popstate',\n    });\n    patch(\n        document.getElementById(options.routerId || options.id || APP_ID) as Element,\n        match.view()\n    );\n}\n\nfunction setPath(location: { hash: string; pathname: string; search: string }) {\n    return location.pathname + (location.search || location.hash);\n}\n\nfunction setTitle({\n    match,\n    path,\n    isPopState,\n}: {\n    match: Match;\n    path: string;\n    isPopState: boolean;\n}): void {\n    const title = getTitle(match) || root.document.title;\n\n    if (!isPopState) {\n        root.history.pushState({}, title, path);\n    }\n\n    root.document.title = title;\n}\n\n// @see https://github.com/jesseditson/fs-router/blob/v0.2.0/index.js#L7\nfunction addMatch(url: string, path: string) {\n    let matched;\n\n    const paramPattern = /:([^/]+)/;\n    const paramNames = [] as Array<any>;\n\n    while ((matched = path.match(paramPattern))) {\n        path = path.replace(paramPattern, '([^?/]+)');\n\n        paramNames.push(matched[1] as never);\n    }\n\n    const pattern = new RegExp(`^${path}(\\\\?(.*)|$)`, 'i');\n    const match = url.match(pattern);\n\n    if (match) {\n        return paramNames.reduce((map: Model, param: string, index: number) => {\n            map[param] = match[index + 1];\n\n            return map;\n        }, {});\n    }\n}\n\nfunction storeMatcher(): SetMatcher {\n    const storeMatches = new Map();\n    const noop = () => {};\n\n    return {\n        set(options: RouterOptions, url: string): Match {\n            if (!storeMatches.has(url)) {\n                let rout = '';\n                let params;\n\n                const optionsRouter = options.router;\n                const routes = Object.keys(optionsRouter);\n                const length = routes.length;\n\n                for (let i = 0; i < length; i = i + 1) {\n                    rout = routes[i];\n                    params = addMatch(url, routes[i]);\n\n                    if (params) {\n                        break;\n                    }\n                }\n\n                const item = optionsRouter[rout];\n\n                storeMatches.set(url, {\n                    params,\n                    title: item.title || noop,\n                    view: item.view || noop,\n                });\n            }\n\n            return storeMatches.get(url);\n        },\n    };\n}\n","import { patch } from '../dom';\nimport { RouterOptions, router } from '../router';\nimport { App } from './app.types';\nimport { APP_ID } from './app.constants';\n\nexport function app(options: App) {\n    const plugin = options.router && router(options as RouterOptions);\n    const view = (plugin && plugin.view) || options.view;\n    const fragment = new DocumentFragment();\n    const tempContainer = document.createElement('div');\n    const appContainer = document.getElementById(options.id || APP_ID);\n\n    if (appContainer?.hasAttribute('data-skip')) return;\n\n    fragment.appendChild(tempContainer);\n    patch((fragment.querySelector('div') as unknown) as Element, view());\n    appContainer?.parentNode?.replaceChild(tempContainer, appContainer as Element);\n}\n","import { patch } from '../dom';\nimport { Props, Render, UpdateResponse } from './component.types';\nimport { quicktask } from '../quicktask';\n\ninterface ComponentFactory {\n    hooks: any;\n    key: string;\n    onCreate: (key: string, element: Element) => void;\n    onDelete: (key: string, element: Element) => void;\n    render: Render;\n    newProps: Props;\n}\n\nconst schedule = quicktask();\n\nexport function componentFactory({\n    hooks,\n    newProps,\n    key,\n    onCreate,\n    onDelete,\n    render,\n}: ComponentFactory) {\n    const noop = () => {};\n    const keys = new Set();\n\n    let element: Element;\n    let created: (element: Element) => void = noop;\n    let deleted: (element: Element) => void = noop;\n    let props: Props = {};\n\n    const update = (currentHook: string) => {\n        return <S>(initialState: S): UpdateResponse<S> => {\n            const setStateHookIndex = currentHook;\n            const setState = (newState: S) => {\n                schedule(() => {\n                    hooks.set(setStateHookIndex, newState);\n                    patch(element, renderElement(props));\n                });\n            };\n\n            if (!hooks.has(currentHook)) {\n                hooks.set(currentHook, initialState);\n                keys.add(currentHook);\n            }\n\n            return [hooks.get(currentHook), setState];\n        };\n    };\n\n    const execute = (currentHook: string) => {\n        return (callback: () => void, depArray: any[]) => {\n            const hasNoDeps = !depArray;\n            const deps = hooks.get(currentHook);\n            const hasChangedDeps = deps\n                ? !depArray.every((item, i) => {\n                      return JSON.stringify(item) === JSON.stringify(deps[i]);\n                  })\n                : true;\n\n            if (hasNoDeps || hasChangedDeps) {\n                schedule(() => {\n                    hooks.set(currentHook, depArray);\n                    keys.add(currentHook);\n                    callback();\n                });\n            }\n        };\n    };\n\n    const renderElement = (nextProps?: Props): (() => Element | null) => {\n        let currentHook = 0;\n\n        props = nextProps || {};\n\n        const reRender = render({\n            created: (callback: (element: Element) => void) => {\n                return (created = callback || created);\n            },\n            deleted: (callback: (element: Element) => void) => {\n                return (deleted = callback || deleted);\n            },\n            execute: (callback: () => void, deps: any[]) => {\n                return execute(`execute-${key}-${currentHook++}`)(callback, deps);\n            },\n            key,\n            props,\n            update: (initialState) => {\n                return update(`update-${key}-${currentHook++}`)(initialState);\n            },\n        });\n\n        if (reRender === null) {\n            return () => {\n                return null;\n            };\n        }\n\n        return function elementCallback() {\n            element = reRender({\n                key,\n                elementAttached: () => {\n                    const e = element as any;\n\n                    e.__hooks = keys;\n                    e.__deleted = deleted;\n\n                    if (props.view) {\n                        e.dataset.view = props.view;\n                    }\n\n                    created(element);\n                    onCreate(key, element);\n                },\n                elementDetached: () => {\n                    onDelete(key, element);\n                },\n            });\n\n            return element;\n        };\n    };\n\n    return renderElement(newProps);\n}\n","import { componentFactory } from './component.factory';\nimport { Props, Render } from './component.types';\n\nlet keyCounter = 1;\n\nconst keyGenerator = () => {\n    return `__${keyCounter++}__`;\n};\n\nconst contains = new Map();\nconst elements = new Map();\nconst hooks = new Map();\n\nconst onDelete = (key: string) => {\n    (contains.get(key) || []).forEach((k: string) => {\n        const containedElement = elements.get(k);\n\n        if (containedElement) {\n            containedElement.__deleted(containedElement);\n            containedElement.__hooks.forEach((h: string) => hooks.delete(h));\n        }\n\n        contains.delete(k);\n        elements.delete(k);\n    });\n};\n\nconst setChildren = (element: Element, key: string) => {\n    // Set children and itself\n    elements.forEach((_, k) => {\n        const domElement = elements.get(k);\n\n        if (domElement && domElement.contains(element)) {\n            contains.set(k, [...(contains.get(k) || []), key]);\n        }\n    });\n};\n\nconst onCreate = (key: string, element: Element) => {\n    elements.set(key, element);\n    setChildren(element, key);\n};\n\nexport function component(render: Render) {\n    function factory(key: string, newProps?: Props) {\n        const _key = newProps && newProps.key ? newProps.key + key : key;\n\n        return componentFactory({\n            hooks,\n            key: _key,\n            newProps: newProps || {},\n            onCreate,\n            onDelete,\n            render,\n        });\n    }\n\n    function init() {\n        return factory.bind(null, keyGenerator());\n    }\n\n    return init;\n}\n"],"names":["getGlobal","globalThis","self","window","global","Error","queueMicrotask","callback","Promise","resolve","then","e","setTimeout","process","nextTick","quicktask","fn","schedule","noop","_","IncrementalDOM","attr","attributes","elementClose","elementOpenEnd","elementOpenStart","notifications","nodesCreated","nodesDeleted","patchOuter","renderToString","skip","skipNode","text","attributesIDom","attrIDom","elementCloseIDom","elementOpenEndIDom","elementOpenStartIDom","notificationsIDom","renderToStringIDom","textIDom","skipIDom","skipNodeIDom","patch","node","value","el","_name","checked","nodes","forEach","_elementDetached","_elementAttached","CAMEL_PROPS","h","tagName","children","attrs","outerArgs","arguments","names","Object","keys","length","render","options","element","elementAttached","elementDetached","key","setAttributes","Array","isArray","renderChildren","forEachChildInArgs","setEvents","ref","isEvent","name","test","isSkip","isRef","i","classProp","forProp","hyphenated","replace","toLowerCase","eventName","substring","_listeners","addEventListener","eventProxy","event","currentTarget","type","args","iteratee","str","APP_ID","root","setClick","matcher","storeMatcher","getParams","params","getTitle","match","title","redirect","href","link","document","createElement","setAttribute","to","preventDefault","initClick","handler","removeEventListener","click","router","set","location","pathname","popState","setTitle","path","setPath","isPopState","view","target","getElementById","routerId","id","search","hash","history","pushState","addMatch","url","matched","paramPattern","paramNames","push","pattern","RegExp","reduce","map","param","index","storeMatches","Map","has","rout","optionsRouter","routes","item","get","app","plugin","fragment","DocumentFragment","tempContainer","appContainer","hasAttribute","appendChild","querySelector","parentNode","replaceChild","componentFactory","hooks","newProps","onCreate","onDelete","Set","created","deleted","props","update","currentHook","initialState","setStateHookIndex","setState","newState","renderElement","add","execute","depArray","hasNoDeps","deps","hasChangedDeps","every","JSON","stringify","nextProps","reRender","elementCallback","__hooks","__deleted","dataset","keyCounter","keyGenerator","contains","elements","k","containedElement","setChildren","domElement","component","factory","_key","init","bind"],"mappings":"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"}