{"version":3,"file":"h-h.esm.js","sources":["../src/quicktask.ts","../src/dom/dom.incremental-dom.ts","../src/dom/dom.hyperscript.ts","../src/app/app.constants.ts","../src/router/router.root.ts","../src/router/router.ts","../src/app/app.ts","../src/component/component.factory.ts","../src/component/component.ts"],"sourcesContent":["// https://github.com/staltz/quicktask/blob/master/index.ts\n// https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/queueMicrotask#When_queueMicrotask_isnt_available\n// https://morioh.com/p/4ca3c63dbc0c\nconst getGlobal = () => {\n    if (typeof globalThis !== 'undefined') return globalThis;\n    // eslint-disable-next-line\n    if (typeof self !== 'undefined') return self;\n    if (typeof window !== 'undefined') return window;\n    if (typeof global !== 'undefined') return global;\n    throw new Error('Unable to locate global object');\n};\n\nconst globalThis: any = getGlobal();\n\nif (typeof globalThis.queueMicrotask !== 'function') {\n    globalThis.queueMicrotask = function queueMicrotask(callback: any) {\n        if (globalThis.Promise) {\n            Promise.resolve()\n                .then(callback)\n                .catch((e) =>\n                    setTimeout(() => {\n                        throw e;\n                    })\n                );\n        } else if (typeof process !== 'undefined') {\n            return process.nextTick(callback);\n        } else {\n            return setTimeout(callback);\n        }\n    };\n}\n\nexport function quicktask() {\n    return (fn: (arg?: any) => void) => globalThis.queueMicrotask(fn);\n}\n","import { HyperScriptNode } from './dom.types';\nimport { quicktask } from '../quicktask';\n\nconst schedule = quicktask();\nconst noop = (_?: unknown) => {};\nconst {\n    attr,\n    attributes = {},\n    elementClose,\n    elementOpenEnd,\n    elementOpenStart,\n    notifications = {\n        nodesCreated: noop,\n        nodesDeleted: noop,\n    },\n    patchOuter,\n    renderToString = noop,\n    skip = noop,\n    skipNode = noop,\n    text,\n    // @ts-ignore\n} = IncrementalDOM;\n\n// @see https://github.com/davidjamesstone/superviews.js/issues/32#issuecomment-274372713\nexport const attributesIDom = attributes || {};\nexport const attrIDom = attr;\nexport const elementCloseIDom = elementClose;\nexport const elementOpenEndIDom = elementOpenEnd;\nexport const elementOpenStartIDom = elementOpenStart;\nexport const notificationsIDom = notifications;\nexport const renderToStringIDom = renderToString;\nexport const textIDom = text;\nexport const skipIDom = skip;\nexport const skipNodeIDom = skipNode;\nexport const patch = (node: Element, fn: (data: unknown) => void) => {\n    return schedule(() => {\n        return patchOuter(node, fn);\n    });\n};\n\nattributesIDom.value = (el: HTMLFormElement, _name: string, value: any) => {\n    return (el.value = value === null || typeof value === 'undefined' ? '' : value);\n};\n\nattributesIDom.checked = (el: HTMLFormElement, _name: string, value: any) => {\n    return (el.checked = !!value);\n};\n\nnotificationsIDom.nodesDeleted = (nodes: HyperScriptNode[]) =>\n    nodes.forEach(\n        (node) => node && node._elementDetached && schedule(node._elementDetached as () => void)\n    );\n\nnotificationsIDom.nodesCreated = (nodes: HyperScriptNode[]) =>\n    nodes.forEach(\n        (node) => node && node._elementAttached && schedule(node._elementAttached as () => void)\n    );\n","import {\n    attrIDom,\n    elementCloseIDom,\n    elementOpenEndIDom,\n    elementOpenStartIDom,\n    skipIDom,\n    textIDom,\n} from './dom.incremental-dom';\nimport { HTMLElements, HTMLElementsAttributes, HyperScriptNode } from './dom.types';\n\nconst handlersCache = new WeakMap();\nconst eventTypes = new Map();\n\nexport function h<T extends HTMLElements>(\n    tagName: T,\n    attributes: HTMLElementsAttributes[T],\n    children: any[]\n) {\n    const attrs = attributes || {};\n    const outerArgs = arguments;\n    const names = Object.keys(attrs);\n    const length = names.length;\n\n    function render(\n        options: {\n            skip: boolean;\n            key?: string;\n            elementAttached?: Function;\n            elementDetached?: Function;\n        } = { skip: false }\n    ) {\n        let element;\n\n        const elementAttached = attrs.elementAttached || options.elementAttached;\n        const elementDetached = attrs.elementDetached || options.elementDetached;\n        const key = attrs.key || options.key || null;\n        const skip = attrs.skip || options.skip || null;\n\n        elementOpenStartIDom(tagName, key);\n        setAttributes({ attributes: attrs, names, length });\n        elementOpenEndIDom();\n\n        if (skip) {\n            skipIDom();\n\n            element = elementCloseIDom(tagName);\n        } else {\n            if (Array.isArray(children)) {\n                children.forEach(renderChildren);\n            } else {\n                forEachChildInArgs(outerArgs, renderChildren);\n            }\n\n            element = elementCloseIDom(tagName) || {};\n\n            element._elementAttached = elementAttached;\n            element._elementDetached = elementDetached;\n\n            if (typeof window !== 'undefined') {\n                setEvents({ attributes: attrs, names, length, element });\n            }\n\n            if (typeof attrs.ref === 'function') {\n                attrs.ref(element);\n            }\n        }\n\n        return element;\n    }\n\n    return render;\n}\n\nfunction isEvent(name: string): boolean {\n    return /^on/.test(name);\n}\n\nfunction isSkip(name: string): boolean {\n    return /^skip$/.test(name);\n}\n\nfunction isRef(name: string): boolean {\n    return /^ref$/.test(name);\n}\n\nfunction setAttributes({\n    attributes,\n    names,\n    length,\n}: {\n    attributes: any;\n    names: Array<string>;\n    length: number;\n}): void {\n    for (let i = 0; i < length; i++) {\n        const name = names[i];\n\n        if (name && !isEvent(name) && !isSkip(name) && !isRef(name)) {\n            const classProp = name === 'className' ? 'class' : '';\n            const forProp = name === 'htmlFor' ? 'for' : '';\n            // @see: https://github.com/shahata/dasherize/blob/master/index.js#L26\n            const hyphenated = name.replace(\n                /[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,\n                function (s: string, j: number) {\n                    return (j > 0 ? '-' : '') + s.toLowerCase();\n                }\n            );\n\n            attrIDom(forProp || classProp || hyphenated, attributes[name]);\n        }\n    }\n}\n\nfunction setEvents({\n    attributes,\n    names,\n    length,\n    element,\n}: {\n    attributes: any;\n    names: Array<string>;\n    length: number;\n    element: HyperScriptNode;\n}): void {\n    for (let i = 0; i < length; i++) {\n        const name = names[i];\n\n        if (name && isEvent(name)) {\n            const eventName = name.toLowerCase().substring(2);\n            const handlers = handlersCache.get(element) || {};\n\n            if (!eventTypes.has(eventName)) {\n                document.body.addEventListener(eventName, eventProxy, false);\n            }\n\n            eventTypes.set(eventName, 1);\n            handlersCache.set(element, { ...handlers, [eventName]: attributes[name] });\n        }\n    }\n}\n\nfunction eventProxy(event: Event) {\n    const element = event.target as any;\n    const handlers = handlersCache.get(element) || {};\n    const type = event.type;\n\n    if (handlers[type]) {\n        return handlers[type](event);\n    }\n}\n\nfunction forEachChildInArgs(args: IArguments, iteratee: Function) {\n    if (args.length > 2) {\n        for (let i = 2; i < args.length; i++) {\n            iteratee(args[i]);\n        }\n    }\n}\n\nfunction renderChildren(children: Function | string | void) {\n    const str = typeof children === 'string' ? textIDom(children) : '';\n\n    return typeof children === 'function' ? children() : str;\n}\n","export const APP_ID = 'app';\n","// @see: https://github.com/purposeindustries/window-or-global/\nexport const root: any =\n    // eslint-disable-next-line\n    (typeof self === 'object' && self.self === self && self) ||\n    // @ts-ignore\n    (typeof global === 'object' && global.global === global && global) ||\n    window;\n","import { APP_ID } from '../app/app.constants';\nimport { View } from '../app/app.types';\nimport { patch } from '../dom';\nimport { root } from './router.root';\nimport { Params, RouterOptions } from './router.types';\n\ninterface Model {\n    [key: string]: any;\n}\n\ninterface Match {\n    params: Params;\n    title: (params: Params) => string;\n    view: View;\n}\n\ninterface SetMatcher {\n    set: (options: RouterOptions, path: string) => Match;\n}\n\nlet setClick: (link: HTMLAnchorElement) => void;\n\nconst matcher = storeMatcher();\nconst getParams = ({ params }: Match) => params;\nconst getTitle = (match: Match): string => match.title(getParams(match));\n\nexport const redirect = (href: string) => {\n    const link = root.document.createElement('a');\n\n    link.setAttribute('href', href);\n    setClick(link);\n};\nexport const to = (event: Event) => {\n    const link = event.target as HTMLAnchorElement;\n\n    event.preventDefault();\n\n    setClick(link);\n};\n\nconst initClick = (options: RouterOptions) => (link: HTMLAnchorElement) => {\n    const handler = (event: Event) => {\n        link.removeEventListener('click', handler);\n        render({ options, event });\n    };\n\n    link.addEventListener('click', handler);\n    link.click();\n};\n\nexport function router(options: RouterOptions) {\n    const path = root.location.pathname;\n    const match = matcher.set(options, path);\n\n    setClick = initClick(options);\n\n    popState(options);\n    setTitle({ match, path, isPopState: false });\n\n    return {\n        view: match.view || options.view,\n    };\n}\n\nfunction popState(options: RouterOptions) {\n    root.addEventListener('popstate', (event: Event) => render({ options, event }));\n}\n\nfunction render({ options, event }: { options: RouterOptions; event: Event }): void {\n    const target = event.currentTarget as HTMLAnchorElement;\n    const path = target.pathname || root.location.pathname;\n    const match = matcher.set(options, path);\n\n    event.preventDefault();\n\n    setTitle({\n        match,\n        path,\n        isPopState: event.type === 'popstate',\n    });\n    patch(\n        document.getElementById(options.routerId || options.id || APP_ID) as Element,\n        match.view()\n    );\n}\n\nfunction setTitle({\n    match,\n    path,\n    isPopState,\n}: {\n    match: Match;\n    path: string;\n    isPopState: boolean;\n}): void {\n    const title = getTitle(match) || root.document.title;\n\n    if (!isPopState) {\n        root.history.pushState({}, title, path);\n    }\n\n    root.document.title = title;\n}\n\n// @see https://github.com/jesseditson/fs-router/blob/v0.2.0/index.js#L7\nfunction addMatch(url: string, path: string) {\n    let matched;\n\n    const paramPattern = /:([^/]+)/;\n    const paramNames = [] as Array<any>;\n\n    while ((matched = path.match(paramPattern))) {\n        path = path.replace(paramPattern, '([^?/]+)');\n\n        paramNames.push(matched[1] as never);\n    }\n\n    const pattern = new RegExp(`^${path}(\\\\?(.*)|$)`, 'i');\n    const match = url.match(pattern);\n\n    if (match) {\n        return paramNames.reduce((map: Model, param: string, index: number) => {\n            map[param] = match[index + 1];\n\n            return map;\n        }, {});\n    }\n}\n\nfunction storeMatcher(): SetMatcher {\n    const storeMatches = new Map();\n    const noop = () => {};\n\n    return {\n        set(options: RouterOptions, url: string): Match {\n            if (!storeMatches.has(url)) {\n                let rout = '';\n                let params;\n\n                const optionsRouter = options.router;\n                const routes = Object.keys(optionsRouter);\n                const length = routes.length;\n\n                for (let i = 0; i < length; i = i + 1) {\n                    rout = routes[i];\n                    params = addMatch(url, routes[i]);\n\n                    if (params) {\n                        break;\n                    }\n                }\n\n                const item = optionsRouter[rout];\n\n                storeMatches.set(url, {\n                    params,\n                    title: item.title || noop,\n                    view: item.view || noop,\n                });\n            }\n\n            return storeMatches.get(url);\n        },\n    };\n}\n","import { patch } from '../dom';\nimport { RouterOptions, router } from '../router';\nimport { App } from './app.types';\nimport { APP_ID } from './app.constants';\n\nexport function app(options: App) {\n    const plugin = options.router && router(options as RouterOptions);\n    const view = (plugin && plugin.view) || options.view;\n    const fragment = new DocumentFragment();\n    const tempContainer = document.createElement('div');\n    const appContainer = document.getElementById(options.id || APP_ID);\n\n    if (appContainer?.hasAttribute('data-skip')) return;\n\n    fragment.appendChild(tempContainer);\n    patch((fragment.querySelector('div') as unknown) as Element, view());\n    appContainer?.parentNode?.replaceChild(tempContainer, appContainer as Element);\n}\n","import { patch } from '../dom';\nimport { Props, Render, UpdateResponse } from './component.types';\nimport { quicktask } from '../quicktask';\n\ninterface ComponentFactory {\n    hooks: any;\n    key: string;\n    onCreate: (key: string, element: Element) => void;\n    onDelete: (key: string, element: Element) => void;\n    render: Render;\n    newProps: Props;\n}\n\nconst schedule = quicktask();\n\nexport function componentFactory({\n    hooks,\n    newProps,\n    key,\n    onCreate,\n    onDelete,\n    render,\n}: ComponentFactory) {\n    const noop = () => {};\n    const keys = new Set();\n\n    let element: Element;\n    let created: (element: Element) => void = noop;\n    let deleted: (element: Element) => void = noop;\n    let props: Props = {};\n\n    const update = (currentHook: string) => {\n        return <S>(initialState: S): UpdateResponse<S> => {\n            const setStateHookIndex = currentHook;\n            const setState = (newState: S) => {\n                schedule(() => {\n                    hooks.set(setStateHookIndex, newState);\n                    patch(element, renderElement(props));\n                });\n            };\n\n            if (!hooks.has(currentHook)) {\n                hooks.set(currentHook, initialState);\n                keys.add(currentHook);\n            }\n\n            return [hooks.get(currentHook), setState];\n        };\n    };\n\n    const execute = (currentHook: string) => {\n        return (callback: () => void, depArray: any[]) => {\n            const hasNoDeps = !depArray;\n            const deps = hooks.get(currentHook);\n            const hasChangedDeps = deps\n                ? !depArray.every((item, i) => {\n                      return JSON.stringify(item) === JSON.stringify(deps[i]);\n                  })\n                : true;\n\n            if (hasNoDeps || hasChangedDeps) {\n                schedule(() => {\n                    hooks.set(currentHook, depArray);\n                    keys.add(currentHook);\n                    callback();\n                });\n            }\n        };\n    };\n\n    const renderElement = (nextProps?: Props): (() => Element | null) => {\n        let currentHook = 0;\n\n        props = nextProps || {};\n\n        const reRender = render({\n            created: (callback: (element: Element) => void) => {\n                return (created = callback || created);\n            },\n            deleted: (callback: (element: Element) => void) => {\n                return (deleted = callback || deleted);\n            },\n            execute: (callback: () => void, deps: any[]) => {\n                return execute(`execute-${key}-${currentHook++}`)(callback, deps);\n            },\n            key,\n            props,\n            update: (initialState) => {\n                return update(`update-${key}-${currentHook++}`)(initialState);\n            },\n        });\n\n        if (reRender === null) {\n            return () => {\n                return null;\n            };\n        }\n\n        return function elementCallback() {\n            element = reRender({\n                key,\n                elementAttached: () => {\n                    const e = element as any;\n\n                    e.__hooks = keys;\n                    e.__deleted = deleted;\n\n                    if (props.view) {\n                        e.dataset.view = props.view;\n                    }\n\n                    created(element);\n                    onCreate(key, element);\n                },\n                elementDetached: () => {\n                    onDelete(key, element);\n                },\n            });\n\n            return element;\n        };\n    };\n\n    return renderElement(newProps);\n}\n","import { componentFactory } from './component.factory';\nimport { Props, Render } from './component.types';\n\nlet keyCounter = 1;\n\nconst keyGenerator = () => {\n    return `__${keyCounter++}__`;\n};\n\nconst contains = new Map();\nconst elements = new Map();\nconst hooks = new Map();\n\nconst onDelete = (key: string) => {\n    (contains.get(key) || []).forEach((k: string) => {\n        const containedElement = elements.get(k);\n\n        if (containedElement) {\n            containedElement.__deleted(containedElement);\n            containedElement.__hooks.forEach((h: string) => hooks.delete(h));\n        }\n\n        contains.delete(k);\n        elements.delete(k);\n    });\n};\n\nconst setChildren = (element: Element, key: string) => {\n    // Set children and itself\n    elements.forEach((_, k) => {\n        const domElement = elements.get(k);\n\n        if (domElement && domElement.contains(element)) {\n            contains.set(k, [...(contains.get(k) || []), key]);\n        }\n    });\n};\n\nconst onCreate = (key: string, element: Element) => {\n    elements.set(key, element);\n    setChildren(element, key);\n};\n\nexport function component(render: Render) {\n    function factory(key: string, newProps?: Props) {\n        const _key = newProps && newProps.key ? newProps.key + key : key;\n\n        return componentFactory({\n            hooks,\n            key: _key,\n            newProps: newProps || {},\n            onCreate,\n            onDelete,\n            render,\n        });\n    }\n\n    function init() {\n        return factory.bind(null, keyGenerator());\n    }\n\n    return init;\n}\n"],"names":["getGlobal","globalThis","self","window","global","Error","queueMicrotask","callback","Promise","resolve","then","e","setTimeout","process","nextTick","quicktask","fn","schedule","noop","_","IncrementalDOM","attr","attributes","elementClose","elementOpenEnd","elementOpenStart","notifications","nodesCreated","nodesDeleted","patchOuter","renderToString","skip","skipNode","text","attributesIDom","attrIDom","elementCloseIDom","elementOpenEndIDom","elementOpenStartIDom","notificationsIDom","renderToStringIDom","textIDom","skipIDom","skipNodeIDom","patch","node","value","el","_name","checked","nodes","forEach","_elementDetached","_elementAttached","handlersCache","WeakMap","eventTypes","Map","h","tagName","children","attrs","outerArgs","arguments","names","Object","keys","length","render","options","element","elementAttached","elementDetached","key","setAttributes","Array","isArray","renderChildren","forEachChildInArgs","setEvents","ref","isEvent","name","test","isSkip","isRef","i","classProp","forProp","hyphenated","replace","s","j","toLowerCase","eventName","substring","handlers","get","has","document","body","addEventListener","eventProxy","set","event","target","type","args","iteratee","str","APP_ID","root","setClick","matcher","storeMatcher","getParams","params","getTitle","match","title","redirect","href","link","createElement","setAttribute","to","preventDefault","initClick","handler","removeEventListener","click","router","path","location","pathname","popState","setTitle","isPopState","view","currentTarget","getElementById","routerId","id","history","pushState","addMatch","url","matched","paramPattern","paramNames","push","pattern","RegExp","reduce","map","param","index","storeMatches","rout","optionsRouter","routes","item","app","plugin","fragment","DocumentFragment","tempContainer","appContainer","hasAttribute","appendChild","querySelector","parentNode","replaceChild","componentFactory","hooks","newProps","onCreate","onDelete","Set","created","deleted","props","update","currentHook","initialState","setStateHookIndex","setState","newState","renderElement","add","execute","depArray","hasNoDeps","deps","hasChangedDeps","every","JSON","stringify","nextProps","reRender","elementCallback","__hooks","__deleted","dataset","keyCounter","keyGenerator","contains","elements","k","containedElement","setChildren","domElement","component","factory","_key","init","bind"],"mappings":"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"}